<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DifferentiationInterface.jl</title><meta name="title" content="API · DifferentiationInterface.jl"/><meta property="og:title" content="API · DifferentiationInterface.jl"/><meta property="twitter:title" content="API · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/basic/">Basic tutorial</a></li><li><a class="tocitem" href="../tutorials/advanced/">Advanced tutorial</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../explanation/operators/">Operators</a></li><li><a class="tocitem" href="../explanation/backends/">Backends</a></li><li><a class="tocitem" href="../explanation/advanced/">Advanced features</a></li></ul></li><li><span class="tocitem">FAQ</span><ul><li><a class="tocitem" href="../faq/limitations/">Limitations</a></li><li><a class="tocitem" href="../faq/differentiability/">Differentiability</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Argument-wrappers"><span>Argument wrappers</span></a></li><li><a class="tocitem" href="#First-order"><span>First order</span></a></li><li><a class="tocitem" href="#Second-order"><span>Second order</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li><li><a class="tocitem" href="../dev_guide/">Dev guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface" href="#DifferentiationInterface"><code>DifferentiationInterface</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DifferentiationInterface</code></pre><p>An interface to various automatic differentiation backends in Julia.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/DifferentiationInterface.jl#L1-L5">source</a></section></article><h2 id="Argument-wrappers"><a class="docs-heading-anchor" href="#Argument-wrappers">Argument wrappers</a><a id="Argument-wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Argument-wrappers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Context" href="#DifferentiationInterface.Context"><code>DifferentiationInterface.Context</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Context</code></pre><p>Abstract supertype for additional context arguments, which can be passed to differentiation operators after the active input <code>x</code> but are not differentiated.</p><p><strong>Subtypes</strong></p><ul><li><a href="#DifferentiationInterface.Constant"><code>Constant</code></a></li><li><a href="#DifferentiationInterface.Cache"><code>Cache</code></a></li><li><a href="#DifferentiationInterface.ConstantOrCache"><code>ConstantOrCache</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Constant" href="#DifferentiationInterface.Constant"><code>DifferentiationInterface.Constant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Constant</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which is kept constant during differentiation.</p><p>Note that an operator can be prepared with an arbitrary value of the constant. However, same-point preparation must occur with the exact value that will be reused later.</p><div class="admonition is-warning" id="Warning-75ba9bdcabd28459"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-75ba9bdcabd28459" title="Permalink"></a></header><div class="admonition-body"><p>Some backends require any <code>Constant</code> context to be a <code>Number</code> or an <code>AbstractArray</code>.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; import ForwardDiff

julia&gt; f(x, c) = c * sum(abs2, x);

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(10))
2-element Vector{Float64}:
 20.0
 40.0

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(100))
2-element Vector{Float64}:
 200.0
 400.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L21-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Cache" href="#DifferentiationInterface.Cache"><code>DifferentiationInterface.Cache</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cache</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which can be mutated with active values during differentiation.</p><p>The initial values present inside the cache do not matter.</p><p>For some backends, preparation allocates the required memory for <code>Cache</code> contexts with the right element type, similar to <a href="https://github.com/SciML/PreallocationTools.jl">PreallocationTools.jl</a>.</p><div class="admonition is-warning" id="Warning-dfa0dbedf35e8003"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-dfa0dbedf35e8003" title="Permalink"></a></header><div class="admonition-body"><p>Some backends require any <code>Cache</code> context to be an <code>AbstractArray</code>, others accept nested (named) tuples of <code>AbstractArray</code>s.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; import ForwardDiff

julia&gt; f(x, c) = sum(copyto!(c, x));

julia&gt; prep = prepare_gradient(f, AutoForwardDiff(), [1.0, 2.0], Cache(zeros(2)));

julia&gt; gradient(f, prep, AutoForwardDiff(), [3.0, 4.0], Cache(zeros(2)))
2-element Vector{Float64}:
 1.0
 1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L60-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ConstantOrCache" href="#DifferentiationInterface.ConstantOrCache"><code>DifferentiationInterface.ConstantOrCache</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantOrCache</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which can contain a mixture of constants and caches, passed along to the backend without modification.</p><p>Unlike for <a href="#DifferentiationInterface.Cache"><code>Cache</code></a>, it is up to the user to ensure that the internal storage can adapt to the required element types, for instance by using <a href="https://github.com/SciML/PreallocationTools.jl">PreallocationTools.jl</a> directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L97-L103">source</a></section></article><h2 id="First-order"><a class="docs-heading-anchor" href="#First-order">First order</a><a id="First-order-1"></a><a class="docs-heading-anchor-permalink" href="#First-order" title="Permalink"></a></h2><h3 id="Pushforward"><a class="docs-heading-anchor" href="#Pushforward">Pushforward</a><a id="Pushforward-1"></a><a class="docs-heading-anchor-permalink" href="#Pushforward" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pushforward" href="#DifferentiationInterface.prepare_pushforward"><code>DifferentiationInterface.prepare_pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pushforward(f,     backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep
prepare_pushforward(f!, y, backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-6d887130b1d30747"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6d887130b1d30747" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pushforward</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pushforward_same_point" href="#DifferentiationInterface.prepare_pushforward_same_point"><code>DifferentiationInterface.prepare_pushforward_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pushforward_same_point(f,     backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep_same
prepare_pushforward_same_point(f!, y, backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-6d887130b1d30747"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6d887130b1d30747" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pushforward</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L65-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward" href="#DifferentiationInterface.pushforward"><code>DifferentiationInterface.pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-9540cf1defb22d8f"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-9540cf1defb22d8f" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L196-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward!" href="#DifferentiationInterface.pushforward!"><code>DifferentiationInterface.pushforward!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-38a6daf423781f41"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-38a6daf423781f41" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L222-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pushforward" href="#DifferentiationInterface.value_and_pushforward"><code>DifferentiationInterface.value_and_pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-b09f16f9b46f4c5"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-b09f16f9b46f4c5" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp</code>.</p></div></div><div class="admonition is-info" id="Info-71cc25df0fbb1cd2"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-71cc25df0fbb1cd2" title="Permalink"></a></header><div class="admonition-body"><p>Required primitive for forward mode backends.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L141-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pushforward!" href="#DifferentiationInterface.value_and_pushforward!"><code>DifferentiationInterface.value_and_pushforward!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-cb8d86801d185634"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-cb8d86801d185634" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L170-L181">source</a></section></article><h3 id="Pullback"><a class="docs-heading-anchor" href="#Pullback">Pullback</a><a id="Pullback-1"></a><a class="docs-heading-anchor-permalink" href="#Pullback" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pullback" href="#DifferentiationInterface.prepare_pullback"><code>DifferentiationInterface.prepare_pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pullback(f,     backend, x, ty, [contexts...]; strict=Val(false)) -&gt; prep
prepare_pullback(f!, y, backend, x, ty, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-cec6ebb2e015eb5b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-cec6ebb2e015eb5b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pullback</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pullback_same_point" href="#DifferentiationInterface.prepare_pullback_same_point"><code>DifferentiationInterface.prepare_pullback_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pullback_same_point(f,     backend, x, ty, [contexts...]; strict=Val(false)) -&gt; prep_same
prepare_pullback_same_point(f!, y, backend, x, ty, [contexts...]; strict=Val(false)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-cec6ebb2e015eb5b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-cec6ebb2e015eb5b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pullback</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L63-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback" href="#DifferentiationInterface.pullback"><code>DifferentiationInterface.pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-2a4f45bb38c76c34"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-2a4f45bb38c76c34" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L192-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback!" href="#DifferentiationInterface.pullback!"><code>DifferentiationInterface.pullback!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-76e85f173817c979"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-76e85f173817c979" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L218-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pullback" href="#DifferentiationInterface.value_and_pullback"><code>DifferentiationInterface.value_and_pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-b885056837357a76"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-b885056837357a76" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp</code>.</p></div></div><div class="admonition is-info" id="Info-20187a392f885203"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-20187a392f885203" title="Permalink"></a></header><div class="admonition-body"><p>Required primitive for reverse mode backends.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L137-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pullback!" href="#DifferentiationInterface.value_and_pullback!"><code>DifferentiationInterface.value_and_pullback!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-5a9ef097f7020178"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-5a9ef097f7020178" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L166-L177">source</a></section></article><h3 id="Derivative"><a class="docs-heading-anchor" href="#Derivative">Derivative</a><a id="Derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Derivative" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_derivative" href="#DifferentiationInterface.prepare_derivative"><code>DifferentiationInterface.prepare_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_derivative(f,     backend, x, [contexts...]; strict=Val(false)) -&gt; prep
prepare_derivative(f!, y, backend, x, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-42e2ed2839eb3705"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-42e2ed2839eb3705" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>derivative</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.derivative" href="#DifferentiationInterface.derivative"><code>DifferentiationInterface.derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">derivative(f,     [prep,] backend, x, [contexts...]) -&gt; der
derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L96-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.derivative!" href="#DifferentiationInterface.derivative!"><code>DifferentiationInterface.derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; der
derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L118-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_derivative" href="#DifferentiationInterface.value_and_derivative"><code>DifferentiationInterface.value_and_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_derivative(f,     [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_derivative!" href="#DifferentiationInterface.value_and_derivative!"><code>DifferentiationInterface.value_and_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L74-L81">source</a></section></article><h3 id="Gradient"><a class="docs-heading-anchor" href="#Gradient">Gradient</a><a id="Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_gradient" href="#DifferentiationInterface.prepare_gradient"><code>DifferentiationInterface.prepare_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_gradient(f, backend, x, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-e7c3b7c32820d18e"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-e7c3b7c32820d18e" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>gradient</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient" href="#DifferentiationInterface.gradient"><code>DifferentiationInterface.gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient(f, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient!" href="#DifferentiationInterface.gradient!"><code>DifferentiationInterface.gradient!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L66-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_gradient" href="#DifferentiationInterface.value_and_gradient"><code>DifferentiationInterface.value_and_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_gradient(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L26-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_gradient!" href="#DifferentiationInterface.value_and_gradient!"><code>DifferentiationInterface.value_and_gradient!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L40-L46">source</a></section></article><h3 id="Jacobian"><a class="docs-heading-anchor" href="#Jacobian">Jacobian</a><a id="Jacobian-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobian" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_jacobian" href="#DifferentiationInterface.prepare_jacobian"><code>DifferentiationInterface.prepare_jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_jacobian(f,     backend, x, [contexts...]; strict=Val(false)) -&gt; prep
prepare_jacobian(f!, y, backend, x, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-67df146542b2e09f"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-67df146542b2e09f" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>jacobian</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian" href="#DifferentiationInterface.jacobian"><code>DifferentiationInterface.jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; jac
jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L96-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian!" href="#DifferentiationInterface.jacobian!"><code>DifferentiationInterface.jacobian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; jac
jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L116-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_jacobian" href="#DifferentiationInterface.value_and_jacobian"><code>DifferentiationInterface.value_and_jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_jacobian!" href="#DifferentiationInterface.value_and_jacobian!"><code>DifferentiationInterface.value_and_jacobian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L74-L81">source</a></section></article><h2 id="Second-order"><a class="docs-heading-anchor" href="#Second-order">Second order</a><a id="Second-order-1"></a><a class="docs-heading-anchor-permalink" href="#Second-order" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.SecondOrder" href="#DifferentiationInterface.SecondOrder"><code>DifferentiationInterface.SecondOrder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SecondOrder</code></pre><p>Combination of two backends for second-order differentiation.</p><div class="admonition is-danger" id="Danger-3185a3f063decf36"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-3185a3f063decf36" title="Permalink"></a></header><div class="admonition-body"><p><code>SecondOrder</code> backends do not support first-order operators.</p></div></div><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">SecondOrder(outer_backend, inner_backend)</code></pre><p><strong>Fields</strong></p><ul><li><code>outer::AbstractADType</code>: backend for the outer differentiation</li><li><code>inner::AbstractADType</code>: backend for the inner differentiation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_order.jl#L1-L17">source</a></section></article><h3 id="Second-derivative"><a class="docs-heading-anchor" href="#Second-derivative">Second derivative</a><a id="Second-derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Second-derivative" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_second_derivative" href="#DifferentiationInterface.prepare_second_derivative"><code>DifferentiationInterface.prepare_second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_second_derivative(f, backend, x, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-be66a846b419fa9e"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-be66a846b419fa9e" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>second_derivative</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.second_derivative" href="#DifferentiationInterface.second_derivative"><code>DifferentiationInterface.second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L32-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.second_derivative!" href="#DifferentiationInterface.second_derivative!"><code>DifferentiationInterface.second_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative!(f, der2, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L46-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_derivative_and_second_derivative" href="#DifferentiationInterface.value_derivative_and_second_derivative"><code>DifferentiationInterface.value_derivative_and_second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L60-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_derivative_and_second_derivative!" href="#DifferentiationInterface.value_derivative_and_second_derivative!"><code>DifferentiationInterface.value_derivative_and_second_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative!(f, der, der2, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code> and <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L74-L80">source</a></section></article><h3 id="Hessian-vector-product"><a class="docs-heading-anchor" href="#Hessian-vector-product">Hessian-vector product</a><a id="Hessian-vector-product-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian-vector-product" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hvp" href="#DifferentiationInterface.prepare_hvp"><code>DifferentiationInterface.prepare_hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hvp(f, backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-da9ea67ea240fdfe"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-da9ea67ea240fdfe" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hvp_same_point" href="#DifferentiationInterface.prepare_hvp_same_point"><code>DifferentiationInterface.prepare_hvp_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hvp_same_point(f, backend, x, tx, [contexts...]; strict=Val(false)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-da9ea67ea240fdfe"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-da9ea67ea240fdfe" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp" href="#DifferentiationInterface.hvp"><code>DifferentiationInterface.hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L66-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp!" href="#DifferentiationInterface.hvp!"><code>DifferentiationInterface.hvp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp!(f, tg, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L78-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient_and_hvp" href="#DifferentiationInterface.gradient_and_hvp"><code>DifferentiationInterface.gradient_and_hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_and_hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L92-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient_and_hvp!" href="#DifferentiationInterface.gradient_and_hvp!"><code>DifferentiationInterface.gradient_and_hvp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_and_hvp!(f, grad, tg, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>grad</code> and <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L106-L112">source</a></section></article><h3 id="Hessian"><a class="docs-heading-anchor" href="#Hessian">Hessian</a><a id="Hessian-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hessian" href="#DifferentiationInterface.prepare_hessian"><code>DifferentiationInterface.prepare_hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hessian(f, backend, x, [contexts...]; strict=Val(false)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-64c45614740eb691"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-64c45614740eb691" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hessian</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian" href="#DifferentiationInterface.hessian"><code>DifferentiationInterface.hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian(f, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L26-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian!" href="#DifferentiationInterface.hessian!"><code>DifferentiationInterface.hessian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian!(f, hess, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L38-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_gradient_and_hessian" href="#DifferentiationInterface.value_gradient_and_hessian"><code>DifferentiationInterface.value_gradient_and_hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_gradient_and_hessian(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_gradient_and_hessian!" href="#DifferentiationInterface.value_gradient_and_hessian!"><code>DifferentiationInterface.value_gradient_and_hessian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_gradient_and_hessian!(f, grad, hess, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code> and <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L66-L72">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><h3 id="Backend-queries"><a class="docs-heading-anchor" href="#Backend-queries">Backend queries</a><a id="Backend-queries-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-queries" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.check_available" href="#DifferentiationInterface.check_available"><code>DifferentiationInterface.check_available</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_available(backend)</code></pre><p>Check whether <code>backend</code> is available (i.e. whether the extension is loaded) and return a <code>Bool</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/check.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.check_inplace" href="#DifferentiationInterface.check_inplace"><code>DifferentiationInterface.check_inplace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_inplace(backend)</code></pre><p>Check whether <code>backend</code> supports differentiation of in-place functions and return a <code>Bool</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/check.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.outer" href="#DifferentiationInterface.outer"><code>DifferentiationInterface.outer</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">outer(backend::SecondOrder)
outer(backend::AbstractADType)</code></pre><p>Return the outer backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the second order.</p><p>For any other backend type, this function acts like the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_order.jl#L46-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inner" href="#DifferentiationInterface.inner"><code>DifferentiationInterface.inner</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inner(backend::SecondOrder)
inner(backend::AbstractADType)</code></pre><p>Return the inner backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the first order.</p><p>For any other backend type, this function acts like the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_order.jl#L35-L42">source</a></section></article><h3 id="Backend-switch"><a class="docs-heading-anchor" href="#Backend-switch">Backend switch</a><a id="Backend-switch-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-switch" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DifferentiateWith" href="#DifferentiationInterface.DifferentiateWith"><code>DifferentiationInterface.DifferentiateWith</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DifferentiateWith</code></pre><p>Function wrapper that enforces differentiation with a &quot;substitute&quot; AD backend, possible different from the &quot;true&quot; AD backend that is called.</p><p>For instance, suppose a function <code>f</code> is not differentiable with Zygote because it involves mutation, but you know that it is differentiable with Enzyme. Then <code>f2 = DifferentiateWith(f, AutoEnzyme())</code> is a new function that behaves like <code>f</code>, except that <code>f2</code> is differentiable with Zygote (thanks to a chain rule which calls Enzyme under the hood). Moreover, any larger algorithm <code>alg</code> that calls <code>f2</code> instead of <code>f</code> will also be differentiable with Zygote (as long as <code>f</code> was the only Zygote blocker).</p><div class="admonition is-success" id="Tip-6571c07ec6640129"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-6571c07ec6640129" title="Permalink"></a></header><div class="admonition-body"><p>This is mainly relevant for package developers who want to produce differentiable code at low cost, without writing the differentiation rules themselves. If you sprinkle a few <code>DifferentiateWith</code> in places where some AD backends may struggle, end users can pick from a wider variety of packages to differentiate your algorithms.</p></div></div><div class="admonition is-warning" id="Warning-6efd93e126449d95"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6efd93e126449d95" title="Permalink"></a></header><div class="admonition-body"><p><code>DifferentiateWith</code> only supports out-of-place functions <code>y = f(x)</code> without additional context arguments. It only makes these functions differentiable if the true backend is either <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff</a> or automatically importing rules from <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules</a> (e.g. <a href="https://github.com/FluxML/Zygote.jl">Zygote</a>). Some backends are also able to <a href="https://juliadiff.org/ChainRulesCore.jl/stable/#Packages-supporting-importing-rules-from-ChainRules.">manually import rules</a> from ChainRules. For any other true backend, the differentiation behavior is not altered by <code>DifferentiateWith</code> (it becomes a transparent wrapper).</p></div></div><p><strong>Fields</strong></p><ul><li><code>f</code>: the function in question, with signature <code>f(x)</code></li><li><code>backend::AbstractADType</code>: the substitute backend to use for differentiation</li></ul><div class="admonition is-info" id="Note-eca1e7c1dab4e403"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-eca1e7c1dab4e403" title="Permalink"></a></header><div class="admonition-body"><p>For the substitute AD backend to be called under the hood, its package needs to be loaded in addition to the package of the true AD backend.</p></div></div><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">DifferentiateWith(f, backend)</code></pre><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; import FiniteDiff, ForwardDiff, Zygote

julia&gt; function f(x::Vector{Float64})
           a = Vector{Float64}(undef, 1)  # type constraint breaks ForwardDiff
           a[1] = sum(abs2, x)  # mutation breaks Zygote
           return a[1]
       end;

julia&gt; f2 = DifferentiateWith(f, AutoFiniteDiff());

julia&gt; f([3.0, 5.0]) == f2([3.0, 5.0])
true

julia&gt; alg(x) = 7 * f2(x);

julia&gt; ForwardDiff.gradient(alg, [3.0, 5.0])
2-element Vector{Float64}:
 42.0
 70.0

julia&gt; Zygote.gradient(alg, [3.0, 5.0])[1]
2-element Vector{Float64}:
 42.0
 70.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/differentiate_with.jl#L1-L61">source</a></section></article><h3 id="Sparsity-tools"><a class="docs-heading-anchor" href="#Sparsity-tools">Sparsity tools</a><a id="Sparsity-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Sparsity-tools" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.MixedMode" href="#DifferentiationInterface.MixedMode"><code>DifferentiationInterface.MixedMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MixedMode</code></pre><p>Combination of a forward and a reverse mode backend for mixed-mode sparse Jacobian computation.</p><div class="admonition is-danger" id="Danger-bd4080efcf33b5e8"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-bd4080efcf33b5e8" title="Permalink"></a></header><div class="admonition-body"><p><code>MixedMode</code> backends only support <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants, and it should be used inside an <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AutoSparse"><code>AutoSparse</code></a> wrapper.</p></div></div><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">MixedMode(forward_backend, reverse_backend)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/mixed_mode.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DenseSparsityDetector" href="#DifferentiationInterface.DenseSparsityDetector"><code>DifferentiationInterface.DenseSparsityDetector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DenseSparsityDetector</code></pre><p>Sparsity pattern detector satisfying the <a href="https://sciml.github.io/ADTypes.jl/stable/#Sparse-AD">detection API</a> of <a href="https://github.com/SciML/ADTypes.jl">ADTypes.jl</a>.</p><p>The nonzeros in a Jacobian or Hessian are detected by computing the relevant matrix with <em>dense</em> AD, and thresholding the entries with a given tolerance (which can be numerically inaccurate). This process can be very slow, and should only be used if its output can be exploited multiple times to compute many sparse matrices.</p><div class="admonition is-danger" id="Danger-bd0a969f49116868"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-bd0a969f49116868" title="Permalink"></a></header><div class="admonition-body"><p>In general, the sparsity pattern you obtain can depend on the provided input <code>x</code>. If you want to reuse the pattern, make sure that it is input-agnostic.</p></div></div><div class="admonition is-warning" id="Warning-48283089b72c5dd1"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-48283089b72c5dd1" title="Permalink"></a></header><div class="admonition-body"><p><code>DenseSparsityDetector</code> functionality is now located in a package extension, please load the SparseArrays.jl standard library before you use it.</p></div></div><p><strong>Fields</strong></p><ul><li><code>backend::AbstractADType</code> is the dense AD backend used under the hood</li><li><code>atol::Float64</code> is the minimum magnitude of a matrix entry to be considered nonzero</li></ul><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">DenseSparsityDetector(backend; atol, method=:iterative)</code></pre><p>The keyword argument <code>method::Symbol</code> can be either:</p><ul><li><code>:iterative</code>: compute the matrix in a sequence of matrix-vector products (memory-efficient)</li><li><code>:direct</code>: compute the matrix all at once (memory-hungry but sometimes faster).</li></ul><p>Note that the constructor is type-unstable because <code>method</code> ends up being a type parameter of the <code>DenseSparsityDetector</code> object (this is not part of the API and might change).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using ADTypes, DifferentiationInterface, SparseArrays
import ForwardDiff

detector = DenseSparsityDetector(AutoForwardDiff(); atol=1e-5, method=:direct)

ADTypes.jacobian_sparsity(diff, rand(5), detector)

# output

4×5 SparseMatrixCSC{Bool, Int64} with 8 stored entries:
 1  1  ⋅  ⋅  ⋅
 ⋅  1  1  ⋅  ⋅
 ⋅  ⋅  1  1  ⋅
 ⋅  ⋅  ⋅  1  1</code></pre><p>Sometimes the sparsity pattern is input-dependent:</p><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], rand(2), detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 2 stored entries:
 1  1</code></pre><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], [0, 1], detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 1 stored entry:
 1  ⋅</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/sparsity_detector.jl#L1-L69">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><p>The following is not part of the public API.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoForwardFromPrimitive" href="#DifferentiationInterface.AutoForwardFromPrimitive"><code>DifferentiationInterface.AutoForwardFromPrimitive</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoForwardFromPrimitive</code></pre><p>Wrapper which forces a given backend to act as a reverse-mode backend.</p><p>Used in internal testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/from_primitive.jl#L14-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoReverseFromPrimitive" href="#DifferentiationInterface.AutoReverseFromPrimitive"><code>DifferentiationInterface.AutoReverseFromPrimitive</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoReverseFromPrimitive</code></pre><p>Wrapper which forces a given backend to act as a reverse-mode backend.</p><p>Used in internal testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/from_primitive.jl#L135-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoSimpleFiniteDiff" href="#DifferentiationInterface.AutoSimpleFiniteDiff"><code>DifferentiationInterface.AutoSimpleFiniteDiff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoSimpleFiniteDiff &lt;: ADTypes.AbstractADType</code></pre><p>Forward mode backend based on the finite difference <code>(f(x + ε) - f(x)) / ε</code>, with artificial chunk size to mimick ForwardDiff.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">AutoSimpleFiniteDiff(ε=1e-5; chunksize=nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/simple_finite_diff.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroForward" href="#DifferentiationInterface.AutoZeroForward"><code>DifferentiationInterface.AutoZeroForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroForward &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/zero_backends.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroReverse" href="#DifferentiationInterface.AutoZeroReverse"><code>DifferentiationInterface.AutoZeroReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroReverse &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/zero_backends.jl#L109-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.BatchSizeSettings" href="#DifferentiationInterface.BatchSizeSettings"><code>DifferentiationInterface.BatchSizeSettings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BatchSizeSettings{B,singlebatch,aligned}</code></pre><p>Configuration for the batch size deduced from a backend and a sample array of length <code>N</code>.</p><p><strong>Type parameters</strong></p><ul><li><code>B::Int</code>: batch size</li><li><code>singlebatch::Bool</code>: whether <code>B == N</code> (<code>B &gt; N</code> is not allowed)</li><li><code>aligned::Bool</code>: whether <code>N % B == 0</code></li></ul><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: array length</li><li><code>A::Int</code>: number of batches <code>A = div(N, B, RoundUp)</code></li><li><code>B_last::Int</code>: size of the last batch (if <code>aligned</code> is <code>false</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/batchsize.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DerivativePrep" href="#DifferentiationInterface.DerivativePrep"><code>DifferentiationInterface.DerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DontPrepareInner" href="#DifferentiationInterface.DontPrepareInner"><code>DifferentiationInterface.DontPrepareInner</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DontPrepareInner</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should not be prepared at all.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L192-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.FixTail" href="#DifferentiationInterface.FixTail"><code>DifferentiationInterface.FixTail</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FixTail</code></pre><p>Closure around a function <code>f</code> and a set of tail argument <code>tail_args</code> such that</p><pre><code class="nohighlight hljs">(ft::FixTail)(args...) = ft.f(args..., ft.tail_args...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L152-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardAndReverseMode" href="#DifferentiationInterface.ForwardAndReverseMode"><code>DifferentiationInterface.ForwardAndReverseMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardAndReverseMode &lt;: ADTypes.AbstractMode</code></pre><p>Appropriate mode type for <code>MixedMode</code> backends.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/mixed_mode.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverForward" href="#DifferentiationInterface.ForwardOverForward"><code>DifferentiationInterface.ForwardOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over forward mode (inefficient).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L137-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverReverse" href="#DifferentiationInterface.ForwardOverReverse"><code>DifferentiationInterface.ForwardOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L116-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.FunctionContext" href="#DifferentiationInterface.FunctionContext"><code>DifferentiationInterface.FunctionContext</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FunctionContext</code></pre><p>Private type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument used for passing functions inside second-order differentiation.</p><p>Behaves differently for Enzyme only, where the function can be annotated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L114-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.GradientPrep" href="#DifferentiationInterface.GradientPrep"><code>DifferentiationInterface.GradientPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HVPPrep" href="#DifferentiationInterface.HVPPrep"><code>DifferentiationInterface.HVPPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HVPPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HessianPrep" href="#DifferentiationInterface.HessianPrep"><code>DifferentiationInterface.HessianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HessianPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceNotSupported" href="#DifferentiationInterface.InPlaceNotSupported"><code>DifferentiationInterface.InPlaceNotSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceNotSupported</code></pre><p>Trait identifying backends that do not support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceSupported" href="#DifferentiationInterface.InPlaceSupported"><code>DifferentiationInterface.InPlaceSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceSupported</code></pre><p>Trait identifying backends that support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.JacobianPrep" href="#DifferentiationInterface.JacobianPrep"><code>DifferentiationInterface.JacobianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JacobianPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PrepareInnerOverload" href="#DifferentiationInterface.PrepareInnerOverload"><code>DifferentiationInterface.PrepareInnerOverload</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrepareInnerOverload</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should be prepared with an overloaded input type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L185-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PrepareInnerSimple" href="#DifferentiationInterface.PrepareInnerSimple"><code>DifferentiationInterface.PrepareInnerSimple</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrepareInnerSimple</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should be prepared with the same input type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L178-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackFast" href="#DifferentiationInterface.PullbackFast"><code>DifferentiationInterface.PullbackFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackFast</code></pre><p>Trait identifying backends that support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackPrep" href="#DifferentiationInterface.PullbackPrep"><code>DifferentiationInterface.PullbackPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackSlow" href="#DifferentiationInterface.PullbackSlow"><code>DifferentiationInterface.PullbackSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackSlow</code></pre><p>Trait identifying backends that do not support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L90-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardFast" href="#DifferentiationInterface.PushforwardFast"><code>DifferentiationInterface.PushforwardFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardFast</code></pre><p>Trait identifying backends that support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardPrep" href="#DifferentiationInterface.PushforwardPrep"><code>DifferentiationInterface.PushforwardPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardSlow" href="#DifferentiationInterface.PushforwardSlow"><code>DifferentiationInterface.PushforwardSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardSlow</code></pre><p>Trait identifying backends that do not support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverForward" href="#DifferentiationInterface.ReverseOverForward"><code>DifferentiationInterface.ReverseOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over forward mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L123-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverReverse" href="#DifferentiationInterface.ReverseOverReverse"><code>DifferentiationInterface.ReverseOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L130-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Rewrap" href="#DifferentiationInterface.Rewrap"><code>DifferentiationInterface.Rewrap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Rewrap</code></pre><p>Utility for recording context types of additional arguments (e.g. <code>Constant</code> or <code>Cache</code>) and re-wrapping them into their types after they have been unwrapped.</p><p>Useful for second-order differentiation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L127-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.SecondDerivativePrep" href="#DifferentiationInterface.SecondDerivativePrep"><code>DifferentiationInterface.SecondDerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SecondDerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/prep.jl#L72-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ADTypes.mode-Tuple{SecondOrder}" href="#ADTypes.mode-Tuple{SecondOrder}"><code>ADTypes.mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mode(backend::SecondOrder)</code></pre><p>Return the <em>outer</em> mode of the second-order backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_order.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.basis-Union{Tuple{T}, Tuple{AbstractArray{T}, Any}} where T" href="#DifferentiationInterface.basis-Union{Tuple{T}, Tuple{AbstractArray{T}, Any}} where T"><code>DifferentiationInterface.basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">basis(a::AbstractArray, i)</code></pre><p>Construct the <code>i</code>-th standard basis array in the vector space of <code>a</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/basis.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.fix_tail-Tuple{F} where F" href="#DifferentiationInterface.fix_tail-Tuple{F} where F"><code>DifferentiationInterface.fix_tail</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_tail(f, tail_args...)</code></pre><p>Convenience for constructing a <a href="#DifferentiationInterface.FixTail"><code>FixTail</code></a>, with a shortcut when there are no tail arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/context.jl#L172-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.forward_backend-Tuple{MixedMode}" href="#DifferentiationInterface.forward_backend-Tuple{MixedMode}"><code>DifferentiationInterface.forward_backend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward_backend(m::MixedMode)</code></pre><p>Return the forward-mode part of a <code>MixedMode</code> backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/mixed_mode.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.get_pattern-Tuple{AbstractMatrix}" href="#DifferentiationInterface.get_pattern-Tuple{AbstractMatrix}"><code>DifferentiationInterface.get_pattern</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pattern(M::AbstractMatrix)</code></pre><p>Return the <code>Bool</code>-valued sparsity pattern for a given matrix.</p><p>Only specialized on <code>SparseMatrixCSC</code> because it is used with symbolic backends, and at the moment their sparse Jacobian/Hessian utilities return a <code>SparseMatrixCSC</code>.</p><p>The trivial dense fallback is designed to protect against a change of format in these packages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/linalg.jl#L26-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.hessian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.hessian_sparsity_with_contexts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian_sparsity_with_contexts(f, detector, x, contexts...)</code></pre><p>Wrapper around <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.hessian_sparsity"><code>ADTypes.hessian_sparsity</code></a> enabling the allocation of caches with proper element types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/sparse.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp_mode-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.hvp_mode-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.hvp_mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp_mode(backend)</code></pre><p>Return the best combination of modes for <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants, among the following options:</p><ul><li><a href="#DifferentiationInterface.ForwardOverForward"><code>ForwardOverForward</code></a></li><li><a href="#DifferentiationInterface.ForwardOverReverse"><code>ForwardOverReverse</code></a></li><li><a href="#DifferentiationInterface.ReverseOverForward"><code>ReverseOverForward</code></a></li><li><a href="#DifferentiationInterface.ReverseOverReverse"><code>ReverseOverReverse</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L146-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inner_preparation_behavior-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.inner_preparation_behavior-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.inner_preparation_behavior</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inner_preparation_behavior(backend::AbstractADType)</code></pre><p>Return <a href="#DifferentiationInterface.PrepareInnerSimple"><code>PrepareInnerSimple</code></a>, <a href="#DifferentiationInterface.PrepareInnerOverload"><code>PrepareInnerOverload</code></a> or <a href="#DifferentiationInterface.DontPrepareInner"><code>DontPrepareInner</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L199-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.inplace_support</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inplace_support(backend)</code></pre><p>Return <a href="#DifferentiationInterface.InPlaceSupported"><code>InPlaceSupported</code></a> or <a href="#DifferentiationInterface.InPlaceNotSupported"><code>InPlaceNotSupported</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ismutable_array-Tuple{Type}" href="#DifferentiationInterface.ismutable_array-Tuple{Type}"><code>DifferentiationInterface.ismutable_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismutable_array(x)</code></pre><p>Check whether <code>x</code> is a mutable array and return a <code>Bool</code>.</p><p>At the moment, this only returns <code>false</code> for <code>StaticArrays.SArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/linalg.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.jacobian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.jacobian_sparsity_with_contexts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian_sparsity_with_contexts(f, detector, x, contexts...)
jacobian_sparsity_with_contexts(f!, y, detector, x, contexts...)</code></pre><p>Wrapper around <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.jacobian_sparsity"><code>ADTypes.jacobian_sparsity</code></a> enabling the allocation of caches with proper element types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/sparse.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.multibasis-Union{Tuple{T}, Tuple{AbstractArray{T}, Any}} where T" href="#DifferentiationInterface.multibasis-Union{Tuple{T}, Tuple{AbstractArray{T}, Any}} where T"><code>DifferentiationInterface.multibasis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multibasis(a::AbstractArray, inds)</code></pre><p>Construct the sum of the <code>i</code>-th standard basis arrays in the vector space of <code>a</code> for all <code>i ∈ inds</code>.</p><div class="admonition is-warning" id="Warning-b1b8ef27e6f31f79"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-b1b8ef27e6f31f79" title="Permalink"></a></header><div class="admonition-body"><p>Does not work on GPU, since this is intended for sparse autodiff and SparseMatrixColorings.jl doesn&#39;t work on GPUs either.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/basis.jl#L17-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.overloaded_input_type" href="#DifferentiationInterface.overloaded_input_type"><code>DifferentiationInterface.overloaded_input_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">overloaded_input_type(prep)</code></pre><p>If it exists, return the overloaded input type which will be passed to the differentiated function when preparation result <code>prep</code> is reused.</p><div class="admonition is-danger" id="Danger-79d00f7997f793ae"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-79d00f7997f793ae" title="Permalink"></a></header><div class="admonition-body"><p>This function is experimental and not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/misc/overloading.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, AbstractArray}" href="#DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, AbstractArray}"><code>DifferentiationInterface.pick_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pick_batchsize(backend, x_or_y::AbstractArray)</code></pre><p>Return a <a href="#DifferentiationInterface.BatchSizeSettings"><code>BatchSizeSettings</code></a> appropriate for arrays of the same length as <code>x_or_y</code> with a given <code>backend</code>.</p><p>Note that the array in question can be either the input or the output of the function, depending on whether the backend performs forward- or reverse-mode AD.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/batchsize.jl#L57-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, Integer}" href="#DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, Integer}"><code>DifferentiationInterface.pick_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pick_batchsize(backend, N::Integer)</code></pre><p>Return a <a href="#DifferentiationInterface.BatchSizeSettings"><code>BatchSizeSettings</code></a> appropriate for arrays of length <code>N</code> with a given <code>backend</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/batchsize.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.DerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.DerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_derivative(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_derivative(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/derivative.jl#L26-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_gradient-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.GradientPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_gradient-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.GradientPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_gradient(f, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/gradient.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hessian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HessianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_hessian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HessianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_hessian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hessian(f, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hessian.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hvp-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HVPPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_hvp-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HVPPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_hvp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hvp(f, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-da9ea67ea240fdfe"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-da9ea67ea240fdfe" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><p>When <code>strict=Val(true)</code>, type checking is enforced between preparation and execution (but size checking is left to the user).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/hvp.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_jacobian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.JacobianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_jacobian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.JacobianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_jacobian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_jacobian(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_jacobian(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/jacobian.jl#L26-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pullback-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PullbackPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_pullback-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PullbackPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_pullback</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pullback(f,     prep, backend, x, ty, [contexts...]) -&gt; new_prep
prepare!_pullback(f!, y, prep, backend, x, ty, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pullback.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pushforward-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PushforwardPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_pushforward-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PushforwardPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_pushforward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pushforward(f,     prep, backend, x, tx, [contexts...]) -&gt; new_prep
prepare!_pushforward(f!, y, prep, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/pushforward.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_second_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.SecondDerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_second_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.SecondDerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_second_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_second_derivative(f, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/second_order/second_derivative.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pullback_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PullbackFast"><code>PullbackFast</code></a> or <a href="#DifferentiationInterface.PullbackSlow"><code>PullbackSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pushforward_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PushforwardFast"><code>PushforwardFast</code></a> or <a href="#DifferentiationInterface.PushforwardSlow"><code>PushforwardSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/traits.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.reasonable_batchsize-Tuple{Integer, Integer}" href="#DifferentiationInterface.reasonable_batchsize-Tuple{Integer, Integer}"><code>DifferentiationInterface.reasonable_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reasonable_batchsize(N::Integer, Bmax::Integer)</code></pre><p>Reproduces the heuristic from ForwardDiff to minimize</p><ol><li>the number of batches necessary to cover an array of length <code>N</code></li><li>the number of leftover indices in the last partial batch</li></ol><p>Source: https://github.com/JuliaDiff/ForwardDiff.jl/blob/ec74fbc32b10bbf60b3c527d8961666310733728/src/prelude.jl#L19-L29</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/batchsize.jl#L122-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.recursive_similar-Union{Tuple{T}, Tuple{AbstractArray, Type{T}}} where T" href="#DifferentiationInterface.recursive_similar-Union{Tuple{T}, Tuple{AbstractArray, Type{T}}} where T"><code>DifferentiationInterface.recursive_similar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">recursive_similar(x, T)</code></pre><p>Apply <code>similar(_, T)</code> recursively to <code>x</code> or its components.</p><p>Works if <code>x</code> is an <code>AbstractArray</code> or a (nested) <code>NTuple</code> / <code>NamedTuple</code> of <code>AbstractArray</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/linalg.jl#L14-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.reverse_backend-Tuple{MixedMode}" href="#DifferentiationInterface.reverse_backend-Tuple{MixedMode}"><code>DifferentiationInterface.reverse_backend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reverse_backend(m::MixedMode)</code></pre><p>Return the reverse-mode part of a <code>MixedMode</code> backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/first_order/mixed_mode.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.threshold_batchsize" href="#DifferentiationInterface.threshold_batchsize"><code>DifferentiationInterface.threshold_batchsize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">threshold_batchsize(backend::AbstractADType, B::Integer)</code></pre><p>If the backend object has a fixed batch size <code>B0</code>, return a new backend where the fixed batch size is <code>min(B0, B)</code>. Otherwise, act as the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/c2bd64f1c234b0b730e3da31fc938bd049ddb4e2/DifferentiationInterface/src/utils/batchsize.jl#L91-L96">source</a></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../faq/differentiability/">« Differentiability</a><a class="docs-footer-nextpage" href="../dev_guide/">Dev guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Sunday 11 May 2025 17:26">Sunday 11 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
