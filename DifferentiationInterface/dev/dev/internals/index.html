<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · DifferentiationInterface.jl</title><meta name="title" content="Internals · DifferentiationInterface.jl"/><meta property="og:title" content="Internals · DifferentiationInterface.jl"/><meta property="twitter:title" content="Internals · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/basic/">Basic tutorial</a></li><li><a class="tocitem" href="../../tutorials/advanced/">Advanced tutorial</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../../explanation/operators/">Operators</a></li><li><a class="tocitem" href="../../explanation/backends/">Backends</a></li><li><a class="tocitem" href="../../explanation/advanced/">Advanced features</a></li></ul></li><li><span class="tocitem">FAQ</span><ul><li><a class="tocitem" href="../../faq/limitations/">Limitations</a></li><li><a class="tocitem" href="../../faq/differentiability/">Differentiability</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Development</span><ul><li class="is-active"><a class="tocitem" href>Internals</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Development</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/dev/internals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><p>The following names are not part of the public API.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoSimpleFiniteDiff" href="#DifferentiationInterface.AutoSimpleFiniteDiff"><code>DifferentiationInterface.AutoSimpleFiniteDiff</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoSimpleFiniteDiff &lt;: ADTypes.AbstractADType</code></pre><p>Forward mode backend based on the finite difference <code>(f(x + ε) - f(x)) / ε</code>, with artificial chunk size to mimick ForwardDiff.</p><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">AutoSimpleFiniteDiff(ε=1e-5; chunksize=nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/misc/simple_finite_diff.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroForward" href="#DifferentiationInterface.AutoZeroForward"><code>DifferentiationInterface.AutoZeroForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroForward &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/misc/zero_backends.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroReverse" href="#DifferentiationInterface.AutoZeroReverse"><code>DifferentiationInterface.AutoZeroReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroReverse &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/misc/zero_backends.jl#L109-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.BatchSizeSettings" href="#DifferentiationInterface.BatchSizeSettings"><code>DifferentiationInterface.BatchSizeSettings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BatchSizeSettings{B,singlebatch,aligned}</code></pre><p>Configuration for the batch size deduced from a backend and a sample array of length <code>N</code>.</p><p><strong>Type parameters</strong></p><ul><li><code>B::Int</code>: batch size</li><li><code>singlebatch::Bool</code>: whether <code>B == N</code> (<code>B &gt; N</code> is only allowed when <code>N == 0</code>)</li><li><code>aligned::Bool</code>: whether <code>N % B == 0</code></li></ul><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: array length</li><li><code>A::Int</code>: number of batches <code>A = div(N, B, RoundUp)</code></li><li><code>B_last::Int</code>: size of the last batch (if <code>aligned</code> is <code>false</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/batchsize.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DerivativePrep" href="#DifferentiationInterface.DerivativePrep"><code>DifferentiationInterface.DerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DontPrepareInner" href="#DifferentiationInterface.DontPrepareInner"><code>DifferentiationInterface.DontPrepareInner</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DontPrepareInner</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should not be prepared at all.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L194-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.FixTail" href="#DifferentiationInterface.FixTail"><code>DifferentiationInterface.FixTail</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FixTail</code></pre><p>Closure around a function <code>f</code> and a set of tail argument <code>tail_args</code> such that</p><pre><code class="language-julia hljs">(ft::FixTail)(args...) = ft.f(args..., ft.tail_args...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/context.jl#L154-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardAndReverseMode" href="#DifferentiationInterface.ForwardAndReverseMode"><code>DifferentiationInterface.ForwardAndReverseMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardAndReverseMode &lt;: ADTypes.AbstractMode</code></pre><p>Appropriate mode type for <code>MixedMode</code> backends.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/mixed_mode.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverForward" href="#DifferentiationInterface.ForwardOverForward"><code>DifferentiationInterface.ForwardOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over forward mode (inefficient).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverReverse" href="#DifferentiationInterface.ForwardOverReverse"><code>DifferentiationInterface.ForwardOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.FunctionContext" href="#DifferentiationInterface.FunctionContext"><code>DifferentiationInterface.FunctionContext</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FunctionContext</code></pre><p>Private type of <a href="../../api/#DifferentiationInterface.Context"><code>Context</code></a> argument used for passing functions inside second-order differentiation.</p><p>Behaves differently for Enzyme only, where the function can be annotated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/context.jl#L116-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.GradientPrep" href="#DifferentiationInterface.GradientPrep"><code>DifferentiationInterface.GradientPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L38-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HVPPrep" href="#DifferentiationInterface.HVPPrep"><code>DifferentiationInterface.HVPPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HVPPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HessianPrep" href="#DifferentiationInterface.HessianPrep"><code>DifferentiationInterface.HessianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HessianPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceNotSupported" href="#DifferentiationInterface.InPlaceNotSupported"><code>DifferentiationInterface.InPlaceNotSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceNotSupported</code></pre><p>Trait identifying backends that do not support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceSupported" href="#DifferentiationInterface.InPlaceSupported"><code>DifferentiationInterface.InPlaceSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceSupported</code></pre><p>Trait identifying backends that support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.JacobianPrep" href="#DifferentiationInterface.JacobianPrep"><code>DifferentiationInterface.JacobianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JacobianPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PrepareInnerOverload" href="#DifferentiationInterface.PrepareInnerOverload"><code>DifferentiationInterface.PrepareInnerOverload</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrepareInnerOverload</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should be prepared with an overloaded input type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L187-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PrepareInnerSimple" href="#DifferentiationInterface.PrepareInnerSimple"><code>DifferentiationInterface.PrepareInnerSimple</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PrepareInnerSimple</code></pre><p>Trait identifying outer backends for which the inner backend in second-order autodiff should be prepared with the same input type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L180-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackFast" href="#DifferentiationInterface.PullbackFast"><code>DifferentiationInterface.PullbackFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackFast</code></pre><p>Trait identifying backends that support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackPrep" href="#DifferentiationInterface.PullbackPrep"><code>DifferentiationInterface.PullbackPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackSlow" href="#DifferentiationInterface.PullbackSlow"><code>DifferentiationInterface.PullbackSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackSlow</code></pre><p>Trait identifying backends that do not support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardFast" href="#DifferentiationInterface.PushforwardFast"><code>DifferentiationInterface.PushforwardFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardFast</code></pre><p>Trait identifying backends that support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L52-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardPrep" href="#DifferentiationInterface.PushforwardPrep"><code>DifferentiationInterface.PushforwardPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardPrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardSlow" href="#DifferentiationInterface.PushforwardSlow"><code>DifferentiationInterface.PushforwardSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardSlow</code></pre><p>Trait identifying backends that do not support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverForward" href="#DifferentiationInterface.ReverseOverForward"><code>DifferentiationInterface.ReverseOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over forward mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverReverse" href="#DifferentiationInterface.ReverseOverReverse"><code>DifferentiationInterface.ReverseOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Rewrap" href="#DifferentiationInterface.Rewrap"><code>DifferentiationInterface.Rewrap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Rewrap</code></pre><p>Utility for recording context types of additional arguments (e.g. <code>Constant</code> or <code>Cache</code>) and re-wrapping them into their types after they have been unwrapped.</p><p>Useful for second-order differentiation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/context.jl#L129-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.SecondDerivativePrep" href="#DifferentiationInterface.SecondDerivativePrep"><code>DifferentiationInterface.SecondDerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SecondDerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="../../api/#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/prep.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ADTypes.mode-Tuple{SecondOrder}" href="#ADTypes.mode-Tuple{SecondOrder}"><code>ADTypes.mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mode(backend::SecondOrder)</code></pre><p>Return the <em>outer</em> mode of the second-order backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/second_order/second_order.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.basis-Tuple{AbstractArray, Any}" href="#DifferentiationInterface.basis-Tuple{AbstractArray, Any}"><code>DifferentiationInterface.basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">basis(a::AbstractArray, i)</code></pre><p>Construct the <code>i</code>-th standard basis array in the vector space of <code>a</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/basis.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.fix_tail-Tuple{F} where F" href="#DifferentiationInterface.fix_tail-Tuple{F} where F"><code>DifferentiationInterface.fix_tail</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_tail(f, tail_args...)</code></pre><p>Convenience for constructing a <a href="#DifferentiationInterface.FixTail"><code>FixTail</code></a>, with a shortcut when there are no tail arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/context.jl#L175-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.forward_backend-Tuple{MixedMode}" href="#DifferentiationInterface.forward_backend-Tuple{MixedMode}"><code>DifferentiationInterface.forward_backend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward_backend(m::MixedMode)</code></pre><p>Return the forward-mode part of a <code>MixedMode</code> backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/mixed_mode.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.get_pattern-Tuple{AbstractMatrix}" href="#DifferentiationInterface.get_pattern-Tuple{AbstractMatrix}"><code>DifferentiationInterface.get_pattern</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pattern(M::AbstractMatrix)</code></pre><p>Return the <code>Bool</code>-valued sparsity pattern for a given matrix.</p><p>Only specialized on <code>SparseMatrixCSC</code> because it is used with symbolic backends, and at the moment their sparse Jacobian/Hessian utilities return a <code>SparseMatrixCSC</code>.</p><p>The trivial dense fallback is designed to protect against a change of format in these packages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/linalg.jl#L26-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.hessian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.hessian_sparsity_with_contexts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian_sparsity_with_contexts(f, detector, x, contexts...)</code></pre><p>Wrapper around <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.hessian_sparsity"><code>ADTypes.hessian_sparsity</code></a> enabling the allocation of caches with proper element types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/sparse.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp_mode-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.hvp_mode-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.hvp_mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp_mode(backend)</code></pre><p>Return the best combination of modes for <a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants, among the following options:</p><ul><li><a href="#DifferentiationInterface.ForwardOverForward"><code>ForwardOverForward</code></a></li><li><a href="#DifferentiationInterface.ForwardOverReverse"><code>ForwardOverReverse</code></a></li><li><a href="#DifferentiationInterface.ReverseOverForward"><code>ReverseOverForward</code></a></li><li><a href="#DifferentiationInterface.ReverseOverReverse"><code>ReverseOverReverse</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L148-L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inner_preparation_behavior-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.inner_preparation_behavior-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.inner_preparation_behavior</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inner_preparation_behavior(backend::AbstractADType)</code></pre><p>Return <a href="#DifferentiationInterface.PrepareInnerSimple"><code>PrepareInnerSimple</code></a>, <a href="#DifferentiationInterface.PrepareInnerOverload"><code>PrepareInnerOverload</code></a> or <a href="#DifferentiationInterface.DontPrepareInner"><code>DontPrepareInner</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L201-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.inplace_support</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inplace_support(backend)</code></pre><p>Return <a href="#DifferentiationInterface.InPlaceSupported"><code>InPlaceSupported</code></a> or <a href="#DifferentiationInterface.InPlaceNotSupported"><code>InPlaceNotSupported</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ismutable_array-Tuple{Type}" href="#DifferentiationInterface.ismutable_array-Tuple{Type}"><code>DifferentiationInterface.ismutable_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ismutable_array(x)</code></pre><p>Check whether <code>x</code> is a mutable array and return a <code>Bool</code>.</p><p>At the moment, this only returns <code>false</code> for <code>StaticArrays.SArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/linalg.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.jacobian_sparsity_with_contexts-Union{Tuple{C}, Tuple{F}, Tuple{F, ADTypes.AbstractSparsityDetector, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.jacobian_sparsity_with_contexts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian_sparsity_with_contexts(f, detector, x, contexts...)
jacobian_sparsity_with_contexts(f!, y, detector, x, contexts...)</code></pre><p>Wrapper around <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.jacobian_sparsity"><code>ADTypes.jacobian_sparsity</code></a> enabling the allocation of caches with proper element types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/sparse.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.multibasis-Tuple{AbstractArray, Any}" href="#DifferentiationInterface.multibasis-Tuple{AbstractArray, Any}"><code>DifferentiationInterface.multibasis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multibasis(a::AbstractArray, inds)</code></pre><p>Construct the sum of the <code>i</code>-th standard basis arrays in the vector space of <code>a</code> for all <code>i ∈ inds</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/basis.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.overloaded_input_type" href="#DifferentiationInterface.overloaded_input_type"><code>DifferentiationInterface.overloaded_input_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">overloaded_input_type(prep)</code></pre><p>If it exists, return the overloaded input type which will be passed to the differentiated function when preparation result <code>prep</code> is reused.</p><div class="admonition is-danger" id="Danger-79d00f7997f793ae"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-79d00f7997f793ae" title="Permalink"></a></header><div class="admonition-body"><p>This function is experimental and not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/misc/overloading.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, AbstractArray}" href="#DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, AbstractArray}"><code>DifferentiationInterface.pick_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pick_batchsize(backend, x_or_y::AbstractArray)</code></pre><p>Return a <a href="#DifferentiationInterface.BatchSizeSettings"><code>BatchSizeSettings</code></a> appropriate for arrays of the same length as <code>x_or_y</code> with a given <code>backend</code>.</p><p>Note that the array in question can be either the input or the output of the function, depending on whether the backend performs forward- or reverse-mode AD.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/batchsize.jl#L61-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, Integer}" href="#DifferentiationInterface.pick_batchsize-Tuple{ADTypes.AbstractADType, Integer}"><code>DifferentiationInterface.pick_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pick_batchsize(backend, N::Integer)</code></pre><p>Return a <a href="#DifferentiationInterface.BatchSizeSettings"><code>BatchSizeSettings</code></a> appropriate for arrays of length <code>N</code> with a given <code>backend</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/batchsize.jl#L48-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.DerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.DerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_derivative(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_derivative(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/derivative.jl#L21-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_gradient-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.GradientPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_gradient-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.GradientPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_gradient(f, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/gradient.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hessian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HessianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_hessian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HessianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_hessian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hessian(f, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/second_order/hessian.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hvp-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HVPPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_hvp-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.HVPPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_hvp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hvp(f, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-da9ea67ea240fdfe"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-da9ea67ea240fdfe" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-c816910b8b954f0b"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-c816910b8b954f0b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/second_order/hvp.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_jacobian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.JacobianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_jacobian-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.JacobianPrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_jacobian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_jacobian(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_jacobian(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/jacobian.jl#L21-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pullback-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PullbackPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_pullback-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PullbackPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_pullback</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pullback(f,     prep, backend, x, ty, [contexts...]) -&gt; new_prep
prepare!_pullback(f!, y, prep, backend, x, ty, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/pullback.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pushforward-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PushforwardPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_pushforward-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.PushforwardPrep, ADTypes.AbstractADType, Any, NTuple{N, T} where {N, T}, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_pushforward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pushforward(f,     prep, backend, x, tx, [contexts...]) -&gt; new_prep
prepare!_pushforward(f!, y, prep, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/pushforward.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_second_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.SecondDerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}" href="#DifferentiationInterface.prepare!_second_derivative-Union{Tuple{C}, Tuple{F}, Tuple{F, DifferentiationInterface.SecondDerivativePrep, ADTypes.AbstractADType, Any, Vararg{Context, C}}} where {F, C}"><code>DifferentiationInterface.prepare!_second_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_second_derivative(f, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="../../api/#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a> but can resize the contents of an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger" id="Danger-506b94fbc5765b64"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-506b94fbc5765b64" title="Permalink"></a></header><div class="admonition-body"><p>Compared to when <code>prep</code> was first created, the only authorized modification is a size change for input <code>x</code> or output <code>y</code>. Any other modification (like a change of type for the input) is not supported and will give erroneous results.</p></div></div><div class="admonition is-danger" id="Danger-76d351e3600c94ba"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-76d351e3600c94ba" title="Permalink"></a></header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/second_order/second_derivative.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pullback_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PullbackFast"><code>PullbackFast</code></a> or <a href="#DifferentiationInterface.PullbackSlow"><code>PullbackSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pushforward_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PushforwardFast"><code>PushforwardFast</code></a> or <a href="#DifferentiationInterface.PushforwardSlow"><code>PushforwardSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/traits.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.reasonable_batchsize-Tuple{Integer, Integer}" href="#DifferentiationInterface.reasonable_batchsize-Tuple{Integer, Integer}"><code>DifferentiationInterface.reasonable_batchsize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reasonable_batchsize(N::Integer, Bmax::Integer)</code></pre><p>Reproduces the heuristic from ForwardDiff to minimize</p><ol><li>the number of batches necessary to cover an array of length <code>N</code></li><li>the number of leftover indices in the last partial batch</li></ol><p>Source: https://github.com/JuliaDiff/ForwardDiff.jl/blob/ec74fbc32b10bbf60b3c527d8961666310733728/src/prelude.jl#L19-L29</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/batchsize.jl#L119-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.recursive_similar-Union{Tuple{T}, Tuple{AbstractArray, Type{T}}} where T" href="#DifferentiationInterface.recursive_similar-Union{Tuple{T}, Tuple{AbstractArray, Type{T}}} where T"><code>DifferentiationInterface.recursive_similar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">recursive_similar(x, T)</code></pre><p>Apply <code>similar(_, T)</code> recursively to <code>x</code> or its components.</p><p>Works if <code>x</code> is an <code>AbstractArray</code> or a (nested) <code>NTuple</code> / <code>NamedTuple</code> of <code>AbstractArray</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/linalg.jl#L14-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.reverse_backend-Tuple{MixedMode}" href="#DifferentiationInterface.reverse_backend-Tuple{MixedMode}"><code>DifferentiationInterface.reverse_backend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reverse_backend(m::MixedMode)</code></pre><p>Return the reverse-mode part of a <code>MixedMode</code> backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/first_order/mixed_mode.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.threshold_batchsize" href="#DifferentiationInterface.threshold_batchsize"><code>DifferentiationInterface.threshold_batchsize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">threshold_batchsize(backend::AbstractADType, B::Integer)</code></pre><p>If the backend object has a fixed batch size <code>B0</code>, return a new backend where the fixed batch size is <code>min(B0, B)</code>. Otherwise, act as the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/01aa04a8ef835f4b91b3ec4ef3233c7e1e6fff2b/DifferentiationInterface/src/utils/batchsize.jl#L95-L100">source</a></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../api/">« API</a><a class="docs-footer-nextpage" href="../contributing/">Contributing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Tuesday 4 November 2025 20:14">Tuesday 4 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
