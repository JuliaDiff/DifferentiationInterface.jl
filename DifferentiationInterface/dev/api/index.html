<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DifferentiationInterface.jl</title><meta name="title" content="API · DifferentiationInterface.jl"/><meta property="og:title" content="API · DifferentiationInterface.jl"/><meta property="twitter:title" content="API · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/basic/">Basic tutorial</a></li><li><a class="tocitem" href="../tutorials/advanced/">Advanced tutorial</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Argument-wrappers"><span>Argument wrappers</span></a></li><li><a class="tocitem" href="#First-order"><span>First order</span></a></li><li><a class="tocitem" href="#Second-order"><span>Second order</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../explanation/arguments/">Arguments</a></li><li><a class="tocitem" href="../explanation/operators/">Operators</a></li><li><a class="tocitem" href="../explanation/backends/">Backends</a></li><li><a class="tocitem" href="../explanation/advanced/">Advanced features</a></li></ul></li><li><span class="tocitem">FAQ</span><ul><li><a class="tocitem" href="../faq/limitations/">Limitations</a></li><li><a class="tocitem" href="../faq/differentiability/">Differentiability</a></li></ul></li><li><span class="tocitem">Development</span><ul><li><a class="tocitem" href="../dev/internals/">Internals</a></li><li><a class="tocitem" href="../dev/math/">Mathematical model</a></li><li><a class="tocitem" href="../dev/contributing/">Contributing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article><details class="docstring"><summary id="DifferentiationInterface"><a class="docstring-binding" href="#DifferentiationInterface"><code>DifferentiationInterface</code></a> — <span class="docstring-category">Module</span></summary><div><pre><code class="language-julia hljs">DifferentiationInterface</code></pre><p>An interface to various automatic differentiation backends in Julia.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/DifferentiationInterface.jl#L1-L5">source</a></div></details></article><h2 id="Argument-wrappers"><a class="docs-heading-anchor" href="#Argument-wrappers">Argument wrappers</a><a id="Argument-wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Argument-wrappers" title="Permalink"></a></h2><article><details class="docstring"><summary id="DifferentiationInterface.Context"><a class="docstring-binding" href="#DifferentiationInterface.Context"><code>DifferentiationInterface.Context</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Context</code></pre><p>Abstract supertype for additional context arguments, which can be passed to differentiation operators after the active input <code>x</code> but are not differentiated.</p><p><strong>Subtypes</strong></p><ul><li><a href="#DifferentiationInterface.Constant"><code>Constant</code></a></li><li><a href="#DifferentiationInterface.Cache"><code>Cache</code></a></li><li><a href="#DifferentiationInterface.ConstantOrCache"><code>ConstantOrCache</code></a></li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/context.jl#L1-L11">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.Constant"><a class="docstring-binding" href="#DifferentiationInterface.Constant"><code>DifferentiationInterface.Constant</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Constant</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which is kept constant during differentiation.</p><p>Note that an operator can be prepared with an arbitrary value of the constant. However, same-point preparation must occur with the exact value that will be reused later.</p><div class="admonition is-warning" id="Warning-f5699742809ccb44"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-f5699742809ccb44" title="Permalink"></a></header><div class="admonition-body"><p>Some backends require any <code>Constant</code> context to be a <code>Number</code> or an <code>AbstractArray</code>.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; using ForwardDiff: ForwardDiff

julia&gt; f(x, c) = c * sum(abs2, x);

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(10))
2-element Vector{Float64}:
 20.0
 40.0

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(100))
2-element Vector{Float64}:
 200.0
 400.0</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/context.jl#L21-L52">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.Cache"><a class="docstring-binding" href="#DifferentiationInterface.Cache"><code>DifferentiationInterface.Cache</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Cache</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which can be mutated with active values during differentiation.</p><p>The initial values present inside the cache do not matter.</p><p>For some backends, preparation allocates the required memory for <code>Cache</code> contexts with the right element type, similar to <a href="https://github.com/SciML/PreallocationTools.jl">PreallocationTools.jl</a>.</p><div class="admonition is-warning" id="Warning-79fbd30b10fef6e6"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-79fbd30b10fef6e6" title="Permalink"></a></header><div class="admonition-body"><p>Some backends require any <code>Cache</code> context to be an <code>AbstractArray</code>, others accept nested (named) tuples of <code>AbstractArray</code>s.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; using ForwardDiff: ForwardDiff

julia&gt; f(x, c) = sum(copyto!(c, x));

julia&gt; prep = prepare_gradient(f, AutoForwardDiff(), [1.0, 2.0], Cache(zeros(2)));

julia&gt; gradient(f, prep, AutoForwardDiff(), [3.0, 4.0], Cache(zeros(2)))
2-element Vector{Float64}:
 1.0
 1.0</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/context.jl#L61-L90">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.ConstantOrCache"><a class="docstring-binding" href="#DifferentiationInterface.ConstantOrCache"><code>DifferentiationInterface.ConstantOrCache</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">ConstantOrCache</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which can contain a mixture of constants and caches, passed along to the backend without modification.</p><p>Unlike for <a href="#DifferentiationInterface.Cache"><code>Cache</code></a>, it is up to the user to ensure that the internal storage can adapt to the required element types, for instance by using <a href="https://github.com/SciML/PreallocationTools.jl">PreallocationTools.jl</a> directly.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/context.jl#L99-L105">source</a></div></details></article><h2 id="First-order"><a class="docs-heading-anchor" href="#First-order">First order</a><a id="First-order-1"></a><a class="docs-heading-anchor-permalink" href="#First-order" title="Permalink"></a></h2><h3 id="Pushforward"><a class="docs-heading-anchor" href="#Pushforward">Pushforward</a><a id="Pushforward-1"></a><a class="docs-heading-anchor-permalink" href="#Pushforward" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_pushforward"><a class="docstring-binding" href="#DifferentiationInterface.prepare_pushforward"><code>DifferentiationInterface.prepare_pushforward</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_pushforward(f,     backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep
prepare_pushforward(f!, y, backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-f1095b657618af2b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-f1095b657618af2b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pushforward</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L3-L8">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.prepare_pushforward_same_point"><a class="docstring-binding" href="#DifferentiationInterface.prepare_pushforward_same_point"><code>DifferentiationInterface.prepare_pushforward_same_point</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_pushforward_same_point(f,     backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep_same
prepare_pushforward_same_point(f!, y, backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-f1095b657618af2b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-f1095b657618af2b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pushforward</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L65-L70">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.pushforward"><a class="docstring-binding" href="#DifferentiationInterface.pushforward"><code>DifferentiationInterface.pushforward</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-6af7694cc5c1abab"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-6af7694cc5c1abab" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L199-L211">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.pushforward!"><a class="docstring-binding" href="#DifferentiationInterface.pushforward!"><code>DifferentiationInterface.pushforward!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-d71ee4621ea16cc2"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-d71ee4621ea16cc2" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp!</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L226-L238">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_pushforward"><a class="docstring-binding" href="#DifferentiationInterface.value_and_pushforward"><code>DifferentiationInterface.value_and_pushforward</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-78fad51d1e4343c9"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-78fad51d1e4343c9" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp</code>.</p></div></div><div class="admonition is-info" id="Info-3831f4c1c1d6eac7"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-3831f4c1c1d6eac7" title="Permalink"></a></header><div class="admonition-body"><p>Required primitive for forward mode backends.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L141-L157">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_pushforward!"><a class="docstring-binding" href="#DifferentiationInterface.value_and_pushforward!"><code>DifferentiationInterface.value_and_pushforward!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success" id="Tip-e0d0242d8caf48c9"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-e0d0242d8caf48c9" title="Permalink"></a></header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp!</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pushforward.jl#L172-L184">source</a></div></details></article><h3 id="Pullback"><a class="docs-heading-anchor" href="#Pullback">Pullback</a><a id="Pullback-1"></a><a class="docs-heading-anchor-permalink" href="#Pullback" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_pullback"><a class="docstring-binding" href="#DifferentiationInterface.prepare_pullback"><code>DifferentiationInterface.prepare_pullback</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_pullback(f,     backend, x, ty, [contexts...]; strict=Val(true)) -&gt; prep
prepare_pullback(f!, y, backend, x, ty, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-fefcd6b5733b05a6"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-fefcd6b5733b05a6" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pullback</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L3-L8">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.prepare_pullback_same_point"><a class="docstring-binding" href="#DifferentiationInterface.prepare_pullback_same_point"><code>DifferentiationInterface.prepare_pullback_same_point</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_pullback_same_point(f,     backend, x, ty, [contexts...]; strict=Val(true)) -&gt; prep_same
prepare_pullback_same_point(f!, y, backend, x, ty, [contexts...]; strict=Val(true)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-fefcd6b5733b05a6"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-fefcd6b5733b05a6" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>pullback</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L63-L68">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.pullback"><a class="docstring-binding" href="#DifferentiationInterface.pullback"><code>DifferentiationInterface.pullback</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-85b54e9dc5c64fdb"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-85b54e9dc5c64fdb" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L195-L207">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.pullback!"><a class="docstring-binding" href="#DifferentiationInterface.pullback!"><code>DifferentiationInterface.pullback!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-b447839975223b23"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-b447839975223b23" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp!</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L222-L234">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_pullback"><a class="docstring-binding" href="#DifferentiationInterface.value_and_pullback"><code>DifferentiationInterface.value_and_pullback</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-6e9f8a6e5ab5bc25"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-6e9f8a6e5ab5bc25" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp</code>.</p></div></div><div class="admonition is-info" id="Info-52c33f318ac7984f"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-52c33f318ac7984f" title="Permalink"></a></header><div class="admonition-body"><p>Required primitive for reverse mode backends.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L137-L153">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_pullback!"><a class="docstring-binding" href="#DifferentiationInterface.value_and_pullback!"><code>DifferentiationInterface.value_and_pullback!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success" id="Tip-912648eb7aafaa89"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-912648eb7aafaa89" title="Permalink"></a></header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp!</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/pullback.jl#L168-L180">source</a></div></details></article><h3 id="Derivative"><a class="docs-heading-anchor" href="#Derivative">Derivative</a><a id="Derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Derivative" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_derivative"><a class="docstring-binding" href="#DifferentiationInterface.prepare_derivative"><code>DifferentiationInterface.prepare_derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_derivative(f,     backend, x, [contexts...]; strict=Val(true)) -&gt; prep
prepare_derivative(f!, y, backend, x, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-d516fec5ad765171"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-d516fec5ad765171" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>derivative</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/derivative.jl#L3-L8">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.derivative"><a class="docstring-binding" href="#DifferentiationInterface.derivative"><code>DifferentiationInterface.derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">derivative(f,     [prep,] backend, x, [contexts...]) -&gt; der
derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/derivative.jl#L90-L97">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.derivative!"><a class="docstring-binding" href="#DifferentiationInterface.derivative!"><code>DifferentiationInterface.derivative!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; der
derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/derivative.jl#L112-L119">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_derivative"><a class="docstring-binding" href="#DifferentiationInterface.value_and_derivative"><code>DifferentiationInterface.value_and_derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_derivative(f,     [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/derivative.jl#L46-L53">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_derivative!"><a class="docstring-binding" href="#DifferentiationInterface.value_and_derivative!"><code>DifferentiationInterface.value_and_derivative!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/derivative.jl#L68-L75">source</a></div></details></article><h3 id="Gradient"><a class="docs-heading-anchor" href="#Gradient">Gradient</a><a id="Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_gradient"><a class="docstring-binding" href="#DifferentiationInterface.prepare_gradient"><code>DifferentiationInterface.prepare_gradient</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_gradient(f, backend, x, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-73225cd94bcd8b3b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-73225cd94bcd8b3b" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>gradient</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/gradient.jl#L3-L7">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.gradient"><a class="docstring-binding" href="#DifferentiationInterface.gradient"><code>DifferentiationInterface.gradient</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gradient(f, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/gradient.jl#L54-L60">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.gradient!"><a class="docstring-binding" href="#DifferentiationInterface.gradient!"><code>DifferentiationInterface.gradient!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/gradient.jl#L66-L72">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_gradient"><a class="docstring-binding" href="#DifferentiationInterface.value_and_gradient"><code>DifferentiationInterface.value_and_gradient</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_gradient(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/gradient.jl#L26-L32">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_gradient!"><a class="docstring-binding" href="#DifferentiationInterface.value_and_gradient!"><code>DifferentiationInterface.value_and_gradient!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/gradient.jl#L40-L46">source</a></div></details></article><h3 id="Jacobian"><a class="docs-heading-anchor" href="#Jacobian">Jacobian</a><a id="Jacobian-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobian" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_jacobian"><a class="docstring-binding" href="#DifferentiationInterface.prepare_jacobian"><code>DifferentiationInterface.prepare_jacobian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_jacobian(f,     backend, x, [contexts...]; strict=Val(true)) -&gt; prep
prepare_jacobian(f!, y, backend, x, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><p>For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p><div class="admonition is-warning" id="Warning-8a09b49f7b4bd325"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-8a09b49f7b4bd325" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>jacobian</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/jacobian.jl#L3-L8">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.jacobian"><a class="docstring-binding" href="#DifferentiationInterface.jacobian"><code>DifferentiationInterface.jacobian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; jac
jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/jacobian.jl#L90-L97">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.jacobian!"><a class="docstring-binding" href="#DifferentiationInterface.jacobian!"><code>DifferentiationInterface.jacobian!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; jac
jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/jacobian.jl#L110-L117">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_jacobian"><a class="docstring-binding" href="#DifferentiationInterface.value_and_jacobian"><code>DifferentiationInterface.value_and_jacobian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/jacobian.jl#L46-L53">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_and_jacobian!"><a class="docstring-binding" href="#DifferentiationInterface.value_and_jacobian!"><code>DifferentiationInterface.value_and_jacobian!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_and_jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/jacobian.jl#L68-L75">source</a></div></details></article><h2 id="Second-order"><a class="docs-heading-anchor" href="#Second-order">Second order</a><a id="Second-order-1"></a><a class="docs-heading-anchor-permalink" href="#Second-order" title="Permalink"></a></h2><article><details class="docstring"><summary id="DifferentiationInterface.SecondOrder"><a class="docstring-binding" href="#DifferentiationInterface.SecondOrder"><code>DifferentiationInterface.SecondOrder</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">SecondOrder</code></pre><p>Combination of two backends for second-order differentiation.</p><div class="admonition is-danger" id="Danger-c1947617d7b4233e"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-c1947617d7b4233e" title="Permalink"></a></header><div class="admonition-body"><p><code>SecondOrder</code> backends do not support first-order operators.</p></div></div><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">SecondOrder(outer_backend, inner_backend)</code></pre><p><strong>Fields</strong></p><ul><li><code>outer::AbstractADType</code>: backend for the outer differentiation</li><li><code>inner::AbstractADType</code>: backend for the inner differentiation</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_order.jl#L1-L18">source</a></div></details></article><h3 id="Second-derivative"><a class="docs-heading-anchor" href="#Second-derivative">Second derivative</a><a id="Second-derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Second-derivative" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_second_derivative"><a class="docstring-binding" href="#DifferentiationInterface.prepare_second_derivative"><code>DifferentiationInterface.prepare_second_derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_second_derivative(f, backend, x, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-7f205eab6c6082f0"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-7f205eab6c6082f0" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>second_derivative</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_derivative.jl#L3-L7">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.second_derivative"><a class="docstring-binding" href="#DifferentiationInterface.second_derivative"><code>DifferentiationInterface.second_derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_derivative.jl#L32-L38">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.second_derivative!"><a class="docstring-binding" href="#DifferentiationInterface.second_derivative!"><code>DifferentiationInterface.second_derivative!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">second_derivative!(f, der2, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_derivative.jl#L46-L52">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_derivative_and_second_derivative"><a class="docstring-binding" href="#DifferentiationInterface.value_derivative_and_second_derivative"><code>DifferentiationInterface.value_derivative_and_second_derivative</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_derivative.jl#L60-L66">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_derivative_and_second_derivative!"><a class="docstring-binding" href="#DifferentiationInterface.value_derivative_and_second_derivative!"><code>DifferentiationInterface.value_derivative_and_second_derivative!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative!(f, der, der2, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code> and <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_derivative.jl#L74-L80">source</a></div></details></article><h3 id="Hessian-vector-product"><a class="docs-heading-anchor" href="#Hessian-vector-product">Hessian-vector product</a><a id="Hessian-vector-product-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian-vector-product" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_hvp"><a class="docstring-binding" href="#DifferentiationInterface.prepare_hvp"><code>DifferentiationInterface.prepare_hvp</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_hvp(f, backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-c64a703fbfd60cfd"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-c64a703fbfd60cfd" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L3-L7">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.prepare_hvp_same_point"><a class="docstring-binding" href="#DifferentiationInterface.prepare_hvp_same_point"><code>DifferentiationInterface.prepare_hvp_same_point</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_hvp_same_point(f, backend, x, tx, [contexts...]; strict=Val(true)) -&gt; prep_same</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants to speed them up, <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-c64a703fbfd60cfd"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-c64a703fbfd60cfd" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hvp</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L36-L40">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.hvp"><a class="docstring-binding" href="#DifferentiationInterface.hvp"><code>DifferentiationInterface.hvp</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L66-L72">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.hvp!"><a class="docstring-binding" href="#DifferentiationInterface.hvp!"><code>DifferentiationInterface.hvp!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">hvp!(f, tg, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L78-L84">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.gradient_and_hvp"><a class="docstring-binding" href="#DifferentiationInterface.gradient_and_hvp"><code>DifferentiationInterface.gradient_and_hvp</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gradient_and_hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L92-L98">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.gradient_and_hvp!"><a class="docstring-binding" href="#DifferentiationInterface.gradient_and_hvp!"><code>DifferentiationInterface.gradient_and_hvp!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">gradient_and_hvp!(f, grad, tg, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>grad</code> and <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hvp.jl#L106-L112">source</a></div></details></article><h3 id="Hessian"><a class="docs-heading-anchor" href="#Hessian">Hessian</a><a id="Hessian-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.prepare_hessian"><a class="docstring-binding" href="#DifferentiationInterface.prepare_hessian"><code>DifferentiationInterface.prepare_hessian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">prepare_hessian(f, backend, x, [contexts...]; strict=Val(true)) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants to speed them up.</p><p>Depending on the backend, this can have several effects (preallocating memory, recording an execution trace) which are transparent to the user.</p><div class="admonition is-warning" id="Warning-50b54628924e96f7"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-50b54628924e96f7" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is only reusable as long as the arguments to <code>hessian</code> do not change type or size, and the function and backend themselves are not modified. Otherwise, preparation becomes invalid and you need to run it again. In some settings, invalid preparations may still give correct results (e.g. for backends that require no preparation), but this is not a semantic guarantee and should not be relied upon.</p></div></div><div class="admonition is-danger" id="Danger-68df46dd6e3cfc35"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-68df46dd6e3cfc35" title="Permalink"></a></header><div class="admonition-body"><p>The preparation result <code>prep</code> is <strong>not thread-safe</strong>. Sharing it between threads may lead to unexpected behavior. If you need to run differentiation concurrently, prepare separate <code>prep</code> objects for each thread.</p></div></div><p>When <code>strict=Val(true)</code> (the default), type checking is enforced between preparation and execution (but size checking is left to the user). While your code may work for different types by setting <code>strict=Val(false)</code>, this is not guaranteed by the API and can break without warning.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hessian.jl#L3-L7">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.hessian"><a class="docstring-binding" href="#DifferentiationInterface.hessian"><code>DifferentiationInterface.hessian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">hessian(f, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hessian.jl#L26-L32">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.hessian!"><a class="docstring-binding" href="#DifferentiationInterface.hessian!"><code>DifferentiationInterface.hessian!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">hessian!(f, hess, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hessian.jl#L38-L44">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_gradient_and_hessian"><a class="docstring-binding" href="#DifferentiationInterface.value_gradient_and_hessian"><code>DifferentiationInterface.value_gradient_and_hessian</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_gradient_and_hessian(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hessian.jl#L52-L58">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.value_gradient_and_hessian!"><a class="docstring-binding" href="#DifferentiationInterface.value_gradient_and_hessian!"><code>DifferentiationInterface.value_gradient_and_hessian!</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">value_gradient_and_hessian!(f, grad, hess, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code> and <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/hessian.jl#L66-L72">source</a></div></details></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><h3 id="Backend-queries"><a class="docs-heading-anchor" href="#Backend-queries">Backend queries</a><a id="Backend-queries-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-queries" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.check_available"><a class="docstring-binding" href="#DifferentiationInterface.check_available"><code>DifferentiationInterface.check_available</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">check_available(backend)</code></pre><p>Check whether <code>backend</code> is available (i.e. whether the extension is loaded) and return a <code>Bool</code>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/check.jl#L1-L5">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.check_inplace"><a class="docstring-binding" href="#DifferentiationInterface.check_inplace"><code>DifferentiationInterface.check_inplace</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">check_inplace(backend)</code></pre><p>Check whether <code>backend</code> supports differentiation of in-place functions and return a <code>Bool</code>.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/check.jl#L21-L25">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.outer"><a class="docstring-binding" href="#DifferentiationInterface.outer"><code>DifferentiationInterface.outer</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">outer(backend::SecondOrder)
outer(backend::AbstractADType)</code></pre><p>Return the outer backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the second order.</p><p>For any other backend type, this function acts like the identity.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_order.jl#L47-L54">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.inner"><a class="docstring-binding" href="#DifferentiationInterface.inner"><code>DifferentiationInterface.inner</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">inner(backend::SecondOrder)
inner(backend::AbstractADType)</code></pre><p>Return the inner backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the first order.</p><p>For any other backend type, this function acts like the identity.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/second_order/second_order.jl#L36-L43">source</a></div></details></article><h3 id="Backend-switch"><a class="docs-heading-anchor" href="#Backend-switch">Backend switch</a><a id="Backend-switch-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-switch" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.DifferentiateWith"><a class="docstring-binding" href="#DifferentiationInterface.DifferentiateWith"><code>DifferentiationInterface.DifferentiateWith</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">DifferentiateWith</code></pre><p>Function wrapper that enforces differentiation with a &quot;substitute&quot; AD backend, possible different from the &quot;true&quot; AD backend that is called.</p><p>For instance, suppose a function <code>f</code> is not differentiable with Zygote because it involves mutation, but you know that it is differentiable with Enzyme. Then <code>f2 = DifferentiateWith(f, AutoEnzyme())</code> is a new function that behaves like <code>f</code>, except that <code>f2</code> is differentiable with Zygote (thanks to a chain rule which calls Enzyme under the hood). Moreover, any larger algorithm <code>alg</code> that calls <code>f2</code> instead of <code>f</code> will also be differentiable with Zygote (as long as <code>f</code> was the only Zygote blocker).</p><div class="admonition is-success" id="Tip-343d5f701f9acfa0"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-343d5f701f9acfa0" title="Permalink"></a></header><div class="admonition-body"><p>This is mainly relevant for package developers who want to produce differentiable code at low cost, without writing the differentiation rules themselves. If you sprinkle a few <code>DifferentiateWith</code> in places where some AD backends may struggle, end users can pick from a wider variety of packages to differentiate your algorithms.</p></div></div><div class="admonition is-warning" id="Warning-b6998de5d197f5f5"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-b6998de5d197f5f5" title="Permalink"></a></header><div class="admonition-body"><p><code>DifferentiateWith</code> only supports out-of-place functions <code>y = f(x)</code> without additional context arguments. It only makes these functions differentiable if the true backend is either <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff</a>, reverse-mode <a href="https://github.com/chalk-lab/Mooncake.jl">Mooncake</a>, or if it automatically importing rules from <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules</a> (e.g. <a href="https://github.com/FluxML/Zygote.jl">Zygote</a>). Some backends are also able to <a href="https://juliadiff.org/ChainRulesCore.jl/stable/#Packages-supporting-importing-rules-from-ChainRules.">manually import rules</a> from ChainRules. For any other true backend, the differentiation behavior is not altered by <code>DifferentiateWith</code> (it becomes a transparent wrapper).</p></div></div><div class="admonition is-warning" id="Warning-196c5c998372dc9b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-196c5c998372dc9b" title="Permalink"></a></header><div class="admonition-body"><p>When using <code>DifferentiateWith(f, AutoSomething())</code>, the function <code>f</code> must not close over any active data. As of now, we cannot differentiate with respect to parameters stored inside <code>f</code>.</p></div></div><p><strong>Fields</strong></p><ul><li><code>f</code>: the function in question, with signature <code>f(x)</code></li><li><code>backend::AbstractADType</code>: the substitute backend to use for differentiation</li></ul><div class="admonition is-info" id="Note-bdb69b718dc7df7c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-bdb69b718dc7df7c" title="Permalink"></a></header><div class="admonition-body"><p>For the substitute AD backend to be called under the hood, its package needs to be loaded in addition to the package of the true AD backend.</p></div></div><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">DifferentiateWith(f, backend)</code></pre><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; using FiniteDiff: FiniteDiff
       using ForwardDiff: ForwardDiff
       using Zygote: Zygote

julia&gt; function f(x::Vector{Float64})
           a = Vector{Float64}(undef, 1)  # type constraint breaks ForwardDiff
           a[1] = sum(abs2, x)  # mutation breaks Zygote
           return a[1]
       end;

julia&gt; f2 = DifferentiateWith(f, AutoFiniteDiff());

julia&gt; f([3.0, 5.0]) == f2([3.0, 5.0])
true

julia&gt; alg(x) = 7 * f2(x);

julia&gt; ForwardDiff.gradient(alg, [3.0, 5.0])
2-element Vector{Float64}:
 42.0
 70.0

julia&gt; Zygote.gradient(alg, [3.0, 5.0])[1]
2-element Vector{Float64}:
 42.0
 70.0</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/misc/differentiate_with.jl#L1-L71">source</a></div></details></article><h3 id="Sparsity-tools"><a class="docs-heading-anchor" href="#Sparsity-tools">Sparsity tools</a><a id="Sparsity-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Sparsity-tools" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.MixedMode"><a class="docstring-binding" href="#DifferentiationInterface.MixedMode"><code>DifferentiationInterface.MixedMode</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">MixedMode</code></pre><p>Combination of a forward and a reverse mode backend for mixed-mode sparse Jacobian computation.</p><div class="admonition is-danger" id="Danger-b11300042812686d"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-b11300042812686d" title="Permalink"></a></header><div class="admonition-body"><p><code>MixedMode</code> backends only support <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants, and it should be used inside an <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AutoSparse"><code>AutoSparse</code></a> wrapper.</p></div></div><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">MixedMode(forward_backend, reverse_backend)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/first_order/mixed_mode.jl#L1-L13">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.DenseSparsityDetector"><a class="docstring-binding" href="#DifferentiationInterface.DenseSparsityDetector"><code>DifferentiationInterface.DenseSparsityDetector</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">DenseSparsityDetector</code></pre><p>Sparsity pattern detector satisfying the <a href="https://sciml.github.io/ADTypes.jl/stable/#Sparse-AD">detection API</a> of <a href="https://github.com/SciML/ADTypes.jl">ADTypes.jl</a>.</p><p>The nonzeros in a Jacobian or Hessian are detected by computing the relevant matrix with <em>dense</em> AD, and thresholding the entries with a given tolerance (which can be numerically inaccurate). This process can be very slow, and should only be used if its output can be exploited multiple times to compute many sparse matrices.</p><div class="admonition is-danger" id="Danger-d6c8b33b2469feaa"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-d6c8b33b2469feaa" title="Permalink"></a></header><div class="admonition-body"><p>In general, the sparsity pattern you obtain can depend on the provided input <code>x</code>. If you want to reuse the pattern, make sure that it is input-agnostic.</p></div></div><div class="admonition is-warning" id="Warning-dfca471d77b8d2c0"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-dfca471d77b8d2c0" title="Permalink"></a></header><div class="admonition-body"><p><code>DenseSparsityDetector</code> functionality is now located in a package extension, please load the SparseArrays.jl standard library before you use it.</p></div></div><p><strong>Fields</strong></p><ul><li><code>backend::AbstractADType</code> is the dense AD backend used under the hood</li><li><code>atol::Float64</code> is the minimum magnitude of a matrix entry to be considered nonzero</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">DenseSparsityDetector(backend; atol, method=:iterative)</code></pre><p>The keyword argument <code>method::Symbol</code> can be either:</p><ul><li><code>:iterative</code>: compute the matrix in a sequence of matrix-vector products (memory-efficient)</li><li><code>:direct</code>: compute the matrix all at once (memory-hungry but sometimes faster).</li></ul><p>Note that the constructor is type-unstable because <code>method</code> ends up being a type parameter of the <code>DenseSparsityDetector</code> object (this is not part of the API and might change).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using ADTypes, DifferentiationInterface, SparseArrays
using ForwardDiff: ForwardDiff

detector = DenseSparsityDetector(AutoForwardDiff(); atol=1e-5, method=:direct)

ADTypes.jacobian_sparsity(diff, rand(5), detector)

# output

4×5 SparseMatrixCSC{Bool, Int64} with 8 stored entries:
 1  1  ⋅  ⋅  ⋅
 ⋅  1  1  ⋅  ⋅
 ⋅  ⋅  1  1  ⋅
 ⋅  ⋅  ⋅  1  1</code></pre><p>Sometimes the sparsity pattern is input-dependent:</p><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], rand(2), detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 2 stored entries:
 1  1</code></pre><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], [0, 1], detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 1 stored entry:
 1  ⋅</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/misc/sparsity_detector.jl#L1-L71">source</a></div></details></article><h3 id="From-primitive"><a class="docs-heading-anchor" href="#From-primitive">From primitive</a><a id="From-primitive-1"></a><a class="docs-heading-anchor-permalink" href="#From-primitive" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.AutoForwardFromPrimitive"><a class="docstring-binding" href="#DifferentiationInterface.AutoForwardFromPrimitive"><code>DifferentiationInterface.AutoForwardFromPrimitive</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">AutoForwardFromPrimitive(backend::AbstractADType)</code></pre><p>Wrapper which forces a given backend to act as a forward-mode backend, using only its native <code>value_and_pushforward</code> primitive and re-implementing the rest from scratch.</p><div class="admonition is-success" id="Tip-ac06cda37c31dd48"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-ac06cda37c31dd48" title="Permalink"></a></header><div class="admonition-body"><p>This can be useful to circumvent high-level operators when they have impractical limitations. For instance, ForwardDiff.jl&#39;s <code>jacobian</code> does not support GPU arrays but its <code>pushforward</code> does, so <code>AutoForwardFromPrimitive(AutoForwardDiff())</code> has a GPU-friendly <code>jacobian</code>.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/misc/from_primitive.jl#L29-L38">source</a></div></details></article><article><details class="docstring"><summary id="DifferentiationInterface.AutoReverseFromPrimitive"><a class="docstring-binding" href="#DifferentiationInterface.AutoReverseFromPrimitive"><code>DifferentiationInterface.AutoReverseFromPrimitive</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">AutoReverseFromPrimitive(backend::AbstractADType)</code></pre><p>Wrapper which forces a given backend to act as a reverse-mode backend, using only its native <code>value_and_pullback</code> implementation and rebuilding the rest from scratch.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/misc/from_primitive.jl#L155-L159">source</a></div></details></article><h3 id="Preparation-type"><a class="docs-heading-anchor" href="#Preparation-type">Preparation type</a><a id="Preparation-type-1"></a><a class="docs-heading-anchor-permalink" href="#Preparation-type" title="Permalink"></a></h3><article><details class="docstring"><summary id="DifferentiationInterface.Prep"><a class="docstring-binding" href="#DifferentiationInterface.Prep"><code>DifferentiationInterface.Prep</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">Prep</code></pre><p>Abstract supertype for all preparation results (outputs of <code>prepare_operator</code> functions).</p><div class="admonition is-warning" id="Warning-d2073876938e5c6b"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-d2073876938e5c6b" title="Permalink"></a></header><div class="admonition-body"><p>The public API does not make any guarantees about the type parameters or field layout of <code>Prep</code>, the only guarantee is that this type exists.</p></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/11796c51a68bcde0ab9472f2d93d53efee1057e5/DifferentiationInterface/src/utils/prep.jl#L1-L8">source</a></div></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/advanced/">« Advanced tutorial</a><a class="docs-footer-nextpage" href="../explanation/arguments/">Arguments »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Thursday 20 November 2025 23:41">Thursday 20 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
