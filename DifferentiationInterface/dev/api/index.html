<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · DifferentiationInterface.jl</title><meta name="title" content="API · DifferentiationInterface.jl"/><meta property="og:title" content="API · DifferentiationInterface.jl"/><meta property="twitter:title" content="API · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/basic/">Basic tutorial</a></li><li><a class="tocitem" href="../tutorials/advanced/">Advanced tutorial</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../explanation/operators/">Operators</a></li><li><a class="tocitem" href="../explanation/backends/">Backends</a></li><li><a class="tocitem" href="../explanation/advanced/">Advanced features</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Argument-wrappers"><span>Argument wrappers</span></a></li><li><a class="tocitem" href="#First-order"><span>First order</span></a></li><li><a class="tocitem" href="#Second-order"><span>Second order</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li><li><a class="tocitem" href="../dev_guide/">Dev guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface" href="#DifferentiationInterface"><code>DifferentiationInterface</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DifferentiationInterface</code></pre><p>An interface to various automatic differentiation backends in Julia.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/DifferentiationInterface.jl#L1-L5">source</a></section></article><h2 id="Argument-wrappers"><a class="docs-heading-anchor" href="#Argument-wrappers">Argument wrappers</a><a id="Argument-wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Argument-wrappers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Context" href="#DifferentiationInterface.Context"><code>DifferentiationInterface.Context</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Context</code></pre><p>Abstract supertype for additional context arguments, which can be passed to differentiation operators after the active input <code>x</code> but are not differentiated.</p><p><strong>See also</strong></p><ul><li><a href="#DifferentiationInterface.Constant"><code>Constant</code></a></li><li><a href="#DifferentiationInterface.Cache"><code>Cache</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/context.jl#L10-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Constant" href="#DifferentiationInterface.Constant"><code>DifferentiationInterface.Constant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Constant</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which is kept constant during differentiation.</p><p>Note that an operator can be prepared with an arbitrary value of the constant. However, same-point preparation must occur with the exact value that will be reused later.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; import ForwardDiff

julia&gt; f(x, c) = c * sum(abs2, x);

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(10))
2-element Vector{Float64}:
 20.0
 40.0

julia&gt; gradient(f, AutoForwardDiff(), [1.0, 2.0], Constant(100))
2-element Vector{Float64}:
 200.0
 400.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/context.jl#L22-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.Cache" href="#DifferentiationInterface.Cache"><code>DifferentiationInterface.Cache</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cache</code></pre><p>Concrete type of <a href="#DifferentiationInterface.Context"><code>Context</code></a> argument which can be mutated with active values during differentiation.</p><p>The initial values present inside the cache do not matter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/context.jl#L60-L66">source</a></section></article><h2 id="First-order"><a class="docs-heading-anchor" href="#First-order">First order</a><a id="First-order-1"></a><a class="docs-heading-anchor-permalink" href="#First-order" title="Permalink"></a></h2><h3 id="Pushforward"><a class="docs-heading-anchor" href="#Pushforward">Pushforward</a><a id="Pushforward-1"></a><a class="docs-heading-anchor-permalink" href="#Pushforward" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pushforward" href="#DifferentiationInterface.prepare_pushforward"><code>DifferentiationInterface.prepare_pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pushforward(f,     backend, x, tx, [contexts...]) -&gt; prep
prepare_pushforward(f!, y, backend, x, tx, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pushforward_same_point" href="#DifferentiationInterface.prepare_pushforward_same_point"><code>DifferentiationInterface.prepare_pushforward_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pushforward_same_point(f,     backend, x, tx, [contexts...]) -&gt; prep_same
prepare_pushforward_same_point(f!, y, backend, x, tx, [contexts...]) -&gt; prep_same</code></pre><p>Create an <code>prep_same</code> object that can be given to <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function or the point changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L28-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward" href="#DifferentiationInterface.pushforward"><code>DifferentiationInterface.pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward!" href="#DifferentiationInterface.pushforward!"><code>DifferentiationInterface.pushforward!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty
pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; ty</code></pre><p>Compute the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>jvp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L85-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pushforward" href="#DifferentiationInterface.value_and_pushforward"><code>DifferentiationInterface.value_and_pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pushforward(f,     [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward(f!, y, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp</code>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Required primitive for forward mode backends.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L40-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pushforward!" href="#DifferentiationInterface.value_and_pushforward!"><code>DifferentiationInterface.value_and_pushforward!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pushforward!(f,     dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)
value_and_pushforward!(f!, y, dy, [prep,] backend, x, tx, [contexts...]) -&gt; (y, ty)</code></pre><p>Compute the value and the pushforward of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> and <a href="#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pushforwards are also commonly called Jacobian-vector products or JVPs. This function could have been named <code>value_and_jvp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L57-L68">source</a></section></article><h3 id="Pullback"><a class="docs-heading-anchor" href="#Pullback">Pullback</a><a id="Pullback-1"></a><a class="docs-heading-anchor-permalink" href="#Pullback" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pullback" href="#DifferentiationInterface.prepare_pullback"><code>DifferentiationInterface.prepare_pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pullback(f,     backend, x, ty, [contexts...]) -&gt; prep
prepare_pullback(f!, y, backend, x, ty, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_pullback_same_point" href="#DifferentiationInterface.prepare_pullback_same_point"><code>DifferentiationInterface.prepare_pullback_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_pullback_same_point(f,     backend, x, ty, [contexts...]) -&gt; prep_same
prepare_pullback_same_point(f!, y, backend, x, ty, [contexts...]) -&gt; prep_same</code></pre><p>Create an <code>prep_same</code> object that can be given to <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function or the point changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L28-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback" href="#DifferentiationInterface.pullback"><code>DifferentiationInterface.pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback!" href="#DifferentiationInterface.pullback!"><code>DifferentiationInterface.pullback!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx
pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; tx</code></pre><p>Compute the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>vjp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L85-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pullback" href="#DifferentiationInterface.value_and_pullback"><code>DifferentiationInterface.value_and_pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pullback(f,     [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback(f!, y, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp</code>.</p></div></div><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Required primitive for reverse mode backends.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L40-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_pullback!" href="#DifferentiationInterface.value_and_pullback!"><code>DifferentiationInterface.value_and_pullback!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_pullback!(f,     dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)
value_and_pullback!(f!, y, dx, [prep,] backend, x, ty, [contexts...]) -&gt; (y, tx)</code></pre><p>Compute the value and the pullback of the function <code>f</code> at point <code>x</code> with a tuple of tangents <code>ty</code>, overwriting <code>dx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> and <a href="#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Pullbacks are also commonly called vector-Jacobian products or VJPs. This function could have been named <code>value_and_vjp!</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L57-L68">source</a></section></article><h3 id="Derivative"><a class="docs-heading-anchor" href="#Derivative">Derivative</a><a id="Derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Derivative" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_derivative" href="#DifferentiationInterface.prepare_derivative"><code>DifferentiationInterface.prepare_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_derivative(f,     backend, x, [contexts...]) -&gt; prep
prepare_derivative(f!, y, backend, x, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.derivative" href="#DifferentiationInterface.derivative"><code>DifferentiationInterface.derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">derivative(f,     [prep,] backend, x, [contexts...]) -&gt; der
derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L48-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.derivative!" href="#DifferentiationInterface.derivative!"><code>DifferentiationInterface.derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; der
derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; der</code></pre><p>Compute the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L58-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_derivative" href="#DifferentiationInterface.value_and_derivative"><code>DifferentiationInterface.value_and_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_derivative(f,     [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L28-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_derivative!" href="#DifferentiationInterface.value_and_derivative!"><code>DifferentiationInterface.value_and_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_derivative!(f,     der, [prep,] backend, x, [contexts...]) -&gt; (y, der)
value_and_derivative!(f!, y, der, [prep,] backend, x, [contexts...]) -&gt; (y, der)</code></pre><p>Compute the value and the derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L38-L45">source</a></section></article><h3 id="Gradient"><a class="docs-heading-anchor" href="#Gradient">Gradient</a><a id="Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_gradient" href="#DifferentiationInterface.prepare_gradient"><code>DifferentiationInterface.prepare_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_gradient(f, backend, x, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient" href="#DifferentiationInterface.gradient"><code>DifferentiationInterface.gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient(f, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient!" href="#DifferentiationInterface.gradient!"><code>DifferentiationInterface.gradient!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; grad</code></pre><p>Compute the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_gradient" href="#DifferentiationInterface.value_and_gradient"><code>DifferentiationInterface.value_and_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_gradient(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L25-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_gradient!" href="#DifferentiationInterface.value_and_gradient!"><code>DifferentiationInterface.value_and_gradient!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_gradient!(f, grad, [prep,] backend, x, [contexts...]) -&gt; (y, grad)</code></pre><p>Compute the value and the gradient of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L34-L40">source</a></section></article><h3 id="Jacobian"><a class="docs-heading-anchor" href="#Jacobian">Jacobian</a><a id="Jacobian-1"></a><a class="docs-heading-anchor-permalink" href="#Jacobian" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_jacobian" href="#DifferentiationInterface.prepare_jacobian"><code>DifferentiationInterface.prepare_jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_jacobian(f,     backend, x, [contexts...]) -&gt; prep
prepare_jacobian(f!, y, backend, x, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again. For in-place functions, <code>y</code> is mutated by <code>f!</code> during preparation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian" href="#DifferentiationInterface.jacobian"><code>DifferentiationInterface.jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; jac
jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L48-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.jacobian!" href="#DifferentiationInterface.jacobian!"><code>DifferentiationInterface.jacobian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; jac
jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; jac</code></pre><p>Compute the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L58-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_jacobian" href="#DifferentiationInterface.value_and_jacobian"><code>DifferentiationInterface.value_and_jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_jacobian(f,     [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian(f!, y, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L28-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_and_jacobian!" href="#DifferentiationInterface.value_and_jacobian!"><code>DifferentiationInterface.value_and_jacobian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_and_jacobian!(f,     jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)
value_and_jacobian!(f!, y, jac, [prep,] backend, x, [contexts...]) -&gt; (y, jac)</code></pre><p>Compute the value and the Jacobian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>jac</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L38-L45">source</a></section></article><h2 id="Second-order"><a class="docs-heading-anchor" href="#Second-order">Second order</a><a id="Second-order-1"></a><a class="docs-heading-anchor-permalink" href="#Second-order" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.SecondOrder" href="#DifferentiationInterface.SecondOrder"><code>DifferentiationInterface.SecondOrder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SecondOrder</code></pre><p>Combination of two backends for second-order differentiation.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p><code>SecondOrder</code> backends do not support first-order operators.</p></div></div><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">SecondOrder(outer_backend, inner_backend)</code></pre><p><strong>Fields</strong></p><ul><li><code>outer::AbstractADType</code>: backend for the outer differentiation</li><li><code>inner::AbstractADType</code>: backend for the inner differentiation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_order.jl#L1-L17">source</a></section></article><h3 id="Second-derivative"><a class="docs-heading-anchor" href="#Second-derivative">Second derivative</a><a id="Second-derivative-1"></a><a class="docs-heading-anchor-permalink" href="#Second-derivative" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_second_derivative" href="#DifferentiationInterface.prepare_second_derivative"><code>DifferentiationInterface.prepare_second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_second_derivative(f, backend, x, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_derivative.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.second_derivative" href="#DifferentiationInterface.second_derivative"><code>DifferentiationInterface.second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_derivative.jl#L13-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.second_derivative!" href="#DifferentiationInterface.second_derivative!"><code>DifferentiationInterface.second_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_derivative!(f, der2, [prep,] backend, x, [contexts...]) -&gt; der2</code></pre><p>Compute the second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_derivative.jl#L22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_derivative_and_second_derivative" href="#DifferentiationInterface.value_derivative_and_second_derivative"><code>DifferentiationInterface.value_derivative_and_second_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative(f, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_derivative.jl#L31-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_derivative_and_second_derivative!" href="#DifferentiationInterface.value_derivative_and_second_derivative!"><code>DifferentiationInterface.value_derivative_and_second_derivative!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_derivative_and_second_derivative!(f, der, der2, [prep,] backend, x, [contexts...]) -&gt; (y, der, der2)</code></pre><p>Compute the value, first derivative and second derivative of the function <code>f</code> at point <code>x</code>, overwriting <code>der</code> and <code>der2</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_derivative.jl#L40-L46">source</a></section></article><h3 id="Hessian-vector-product"><a class="docs-heading-anchor" href="#Hessian-vector-product">Hessian-vector product</a><a id="Hessian-vector-product-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian-vector-product" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hvp" href="#DifferentiationInterface.prepare_hvp"><code>DifferentiationInterface.prepare_hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hvp(f, backend, x, tx, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hvp_same_point" href="#DifferentiationInterface.prepare_hvp_same_point"><code>DifferentiationInterface.prepare_hvp_same_point</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hvp_same_point(f, backend, x, tx, [contexts...]) -&gt; prep_same</code></pre><p>Create an <code>prep_same</code> object that can be given to <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants <em>if they are applied at the same point <code>x</code> and with the same <code>contexts</code></em>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function or the point changes in any way, the result of preparation will be invalidated, and you will need to run it again.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp" href="#DifferentiationInterface.hvp"><code>DifferentiationInterface.hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L35-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hvp!" href="#DifferentiationInterface.hvp!"><code>DifferentiationInterface.hvp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hvp!(f, tg, [prep,] backend, x, tx, [contexts...]) -&gt; tg</code></pre><p>Compute the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L44-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient_and_hvp" href="#DifferentiationInterface.gradient_and_hvp"><code>DifferentiationInterface.gradient_and_hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_and_hvp(f, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L53-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.gradient_and_hvp!" href="#DifferentiationInterface.gradient_and_hvp!"><code>DifferentiationInterface.gradient_and_hvp!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_and_hvp!(f, grad, tg, [prep,] backend, x, tx, [contexts...]) -&gt; (grad, tg)</code></pre><p>Compute the gradient and the Hessian-vector product of <code>f</code> at point <code>x</code> with a tuple of tangents <code>tx</code>, overwriting <code>grad</code> and <code>tg</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> and <a href="#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L62-L68">source</a></section></article><h3 id="Hessian"><a class="docs-heading-anchor" href="#Hessian">Hessian</a><a id="Hessian-1"></a><a class="docs-heading-anchor-permalink" href="#Hessian" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare_hessian" href="#DifferentiationInterface.prepare_hessian"><code>DifferentiationInterface.prepare_hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_hessian(f, backend, x, [contexts...]) -&gt; prep</code></pre><p>Create a <code>prep</code> object that can be given to <a href="#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the function changes in any way, the result of preparation will be invalidated, and you will need to run it again.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian" href="#DifferentiationInterface.hessian"><code>DifferentiationInterface.hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian(f, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L25-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.hessian!" href="#DifferentiationInterface.hessian!"><code>DifferentiationInterface.hessian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hessian!(f, hess, [prep,] backend, x, [contexts...]) -&gt; hess</code></pre><p>Compute the Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L34-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_gradient_and_hessian" href="#DifferentiationInterface.value_gradient_and_hessian"><code>DifferentiationInterface.value_gradient_and_hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_gradient_and_hessian(f, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.value_gradient_and_hessian!" href="#DifferentiationInterface.value_gradient_and_hessian!"><code>DifferentiationInterface.value_gradient_and_hessian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value_gradient_and_hessian!(f, grad, hess, [prep,] backend, x, [contexts...]) -&gt; (y, grad, hess)</code></pre><p>Compute the value, gradient vector and Hessian matrix of the function <code>f</code> at point <code>x</code>, overwriting <code>grad</code> and <code>hess</code>.</p><p>To improve performance via operator preparation, refer to <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L52-L58">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><h3 id="Backend-queries"><a class="docs-heading-anchor" href="#Backend-queries">Backend queries</a><a id="Backend-queries-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-queries" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.check_available" href="#DifferentiationInterface.check_available"><code>DifferentiationInterface.check_available</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_available(backend)</code></pre><p>Check whether <code>backend</code> is available (i.e. whether the extension is loaded).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/check.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.check_inplace" href="#DifferentiationInterface.check_inplace"><code>DifferentiationInterface.check_inplace</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_inplace(backend)</code></pre><p>Check whether <code>backend</code> supports differentiation of in-place functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/check.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.outer" href="#DifferentiationInterface.outer"><code>DifferentiationInterface.outer</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">outer(backend::SecondOrder)
outer(backend::AbstractADType)</code></pre><p>Return the outer backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the second order.</p><p>For any other backend type, this function acts like the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_order.jl#L46-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inner" href="#DifferentiationInterface.inner"><code>DifferentiationInterface.inner</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inner(backend::SecondOrder)
inner(backend::AbstractADType)</code></pre><p>Return the inner backend of a <a href="#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> object, tasked with differentiation at the first order.</p><p>For any other backend type, this function acts like the identity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_order.jl#L35-L42">source</a></section></article><h3 id="Backend-switch"><a class="docs-heading-anchor" href="#Backend-switch">Backend switch</a><a id="Backend-switch-1"></a><a class="docs-heading-anchor-permalink" href="#Backend-switch" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DifferentiateWith" href="#DifferentiationInterface.DifferentiateWith"><code>DifferentiationInterface.DifferentiateWith</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DifferentiateWith</code></pre><p>Function wrapper that enforces differentiation with a &quot;substitute&quot; AD backend, possible different from the &quot;true&quot; AD backend that is called.</p><p>For instance, suppose a function <code>f</code> is not differentiable with Zygote because it involves mutation, but you know that it is differentiable with Enzyme. Then <code>f2 = DifferentiateWith(f, AutoEnzyme())</code> is a new function that behaves like <code>f</code>, except that <code>f2</code> is differentiable with Zygote (thanks to a chain rule which calls Enzyme under the hood). Moreover, any larger algorithm <code>alg</code> that calls <code>f2</code> instead of <code>f</code> will also be differentiable with Zygote (as long as <code>f</code> was the only Zygote blocker).</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This is mainly relevant for package developers who want to produce differentiable code at low cost, without writing the differentiation rules themselves. If you sprinkle a few <code>DifferentiateWith</code> in places where some AD backends may struggle, end users can pick from a wider variety of packages to differentiate your algorithms.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>DifferentiateWith</code> only supports out-of-place functions <code>y = f(x)</code> without additional context arguments. It only makes these functions differentiable if the true backend is either <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff</a> or compatible with <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules</a>. For any other true backend, the differentiation behavior is not altered by <code>DifferentiateWith</code> (it becomes a transparent wrapper).</p></div></div><p><strong>Fields</strong></p><ul><li><code>f</code>: the function in question, with signature <code>f(x)</code></li><li><code>backend::AbstractADType</code>: the substitute backend to use for differentiation</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For the substitute AD backend to be called under the hood, its package needs to be loaded in addition to the package of the true AD backend.</p></div></div><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">DifferentiateWith(f, backend)</code></pre><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using DifferentiationInterface

julia&gt; import FiniteDiff, ForwardDiff, Zygote

julia&gt; function f(x::Vector{Float64})
           a = Vector{Float64}(undef, 1)  # type constraint breaks ForwardDiff
           a[1] = sum(abs2, x)  # mutation breaks Zygote
           return a[1]
       end;

julia&gt; f2 = DifferentiateWith(f, AutoFiniteDiff());

julia&gt; f([3.0, 5.0]) == f2([3.0, 5.0])
true

julia&gt; alg(x) = 7 * f2(x);

julia&gt; ForwardDiff.gradient(alg, [3.0, 5.0])
2-element Vector{Float64}:
 42.0
 70.0

julia&gt; Zygote.gradient(alg, [3.0, 5.0])[1]
2-element Vector{Float64}:
 42.0
 70.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/misc/differentiate_with.jl#L1-L61">source</a></section></article><h3 id="Sparsity-detection"><a class="docs-heading-anchor" href="#Sparsity-detection">Sparsity detection</a><a id="Sparsity-detection-1"></a><a class="docs-heading-anchor-permalink" href="#Sparsity-detection" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DenseSparsityDetector" href="#DifferentiationInterface.DenseSparsityDetector"><code>DifferentiationInterface.DenseSparsityDetector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DenseSparsityDetector</code></pre><p>Sparsity pattern detector satisfying the <a href="https://sciml.github.io/ADTypes.jl/stable/#Sparse-AD">detection API</a> of <a href="https://github.com/SciML/ADTypes.jl">ADTypes.jl</a>.</p><p>The nonzeros in a Jacobian or Hessian are detected by computing the relevant matrix with <em>dense</em> AD, and thresholding the entries with a given tolerance (which can be numerically inaccurate). This process can be very slow, and should only be used if its output can be exploited multiple times to compute many sparse matrices.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>In general, the sparsity pattern you obtain can depend on the provided input <code>x</code>. If you want to reuse the pattern, make sure that it is input-agnostic.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><code>DenseSparsityDetector</code> functionality is now located in a package extension, please load the SparseArrays.jl standard library before you use it.</p></div></div><p><strong>Fields</strong></p><ul><li><code>backend::AbstractADType</code> is the dense AD backend used under the hood</li><li><code>atol::Float64</code> is the minimum magnitude of a matrix entry to be considered nonzero</li></ul><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">DenseSparsityDetector(backend; atol, method=:iterative)</code></pre><p>The keyword argument <code>method::Symbol</code> can be either:</p><ul><li><code>:iterative</code>: compute the matrix in a sequence of matrix-vector products (memory-efficient)</li><li><code>:direct</code>: compute the matrix all at once (memory-hungry but sometimes faster).</li></ul><p>Note that the constructor is type-unstable because <code>method</code> ends up being a type parameter of the <code>DenseSparsityDetector</code> object (this is not part of the API and might change).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using ADTypes, DifferentiationInterface, SparseArrays
import ForwardDiff

detector = DenseSparsityDetector(AutoForwardDiff(); atol=1e-5, method=:direct)

ADTypes.jacobian_sparsity(diff, rand(5), detector)

# output

4×5 SparseMatrixCSC{Bool, Int64} with 8 stored entries:
 1  1  ⋅  ⋅  ⋅
 ⋅  1  1  ⋅  ⋅
 ⋅  ⋅  1  1  ⋅
 ⋅  ⋅  ⋅  1  1</code></pre><p>Sometimes the sparsity pattern is input-dependent:</p><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], rand(2), detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 2 stored entries:
 1  1</code></pre><pre><code class="language-julia hljs">ADTypes.jacobian_sparsity(x -&gt; [prod(x)], [0, 1], detector)

# output

1×2 SparseMatrixCSC{Bool, Int64} with 1 stored entry:
 1  ⋅</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/misc/sparsity_detector.jl#L1-L69">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><p>The following is not part of the public API.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroForward" href="#DifferentiationInterface.AutoZeroForward"><code>DifferentiationInterface.AutoZeroForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroForward &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/misc/zero_backends.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.AutoZeroReverse" href="#DifferentiationInterface.AutoZeroReverse"><code>DifferentiationInterface.AutoZeroReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AutoZeroReverse &lt;: ADTypes.AbstractADType</code></pre><p>Trivial backend that sets all derivatives to zero. Used in testing and benchmarking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/misc/zero_backends.jl#L97-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.BatchSizeSettings" href="#DifferentiationInterface.BatchSizeSettings"><code>DifferentiationInterface.BatchSizeSettings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BatchSizeSettings{B,singlebatch,aligned}</code></pre><p>Configuration for the batch size deduced from a backend and a sample array of length <code>N</code>.</p><p><strong>Type parameters</strong></p><ul><li><code>B::Int</code>: batch size</li><li><code>singlebatch::Bool</code>: whether <code>B &gt; N</code></li><li><code>aligned::Bool</code>: whether <code>N % B == 0</code></li></ul><p><strong>Fields</strong></p><ul><li><code>N::Int</code>: array length</li><li><code>A::Int</code>: number of batches <code>A = div(N, B, RoundUp)</code></li><li><code>B_last::Int</code>: size of the last batch (if <code>aligned</code> is <code>false</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/batchsize.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.DerivativePrep" href="#DifferentiationInterface.DerivativePrep"><code>DifferentiationInterface.DerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.derivative"><code>derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverForward" href="#DifferentiationInterface.ForwardOverForward"><code>DifferentiationInterface.ForwardOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over forward mode (inefficient).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L128-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ForwardOverReverse" href="#DifferentiationInterface.ForwardOverReverse"><code>DifferentiationInterface.ForwardOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ForwardOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in forward over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.GradientPrep" href="#DifferentiationInterface.GradientPrep"><code>DifferentiationInterface.GradientPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GradientPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.gradient"><code>gradient</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HVPPrep" href="#DifferentiationInterface.HVPPrep"><code>DifferentiationInterface.HVPPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HVPPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.hvp"><code>hvp</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.HessianPrep" href="#DifferentiationInterface.HessianPrep"><code>DifferentiationInterface.HessianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HessianPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.hessian"><code>hessian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceNotSupported" href="#DifferentiationInterface.InPlaceNotSupported"><code>DifferentiationInterface.InPlaceNotSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceNotSupported</code></pre><p>Trait identifying backends that do not support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.InPlaceSupported" href="#DifferentiationInterface.InPlaceSupported"><code>DifferentiationInterface.InPlaceSupported</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InPlaceSupported</code></pre><p>Trait identifying backends that support in-place functions <code>f!(y, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.JacobianPrep" href="#DifferentiationInterface.JacobianPrep"><code>DifferentiationInterface.JacobianPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JacobianPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.jacobian"><code>jacobian</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackFast" href="#DifferentiationInterface.PullbackFast"><code>DifferentiationInterface.PullbackFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackFast</code></pre><p>Trait identifying backends that support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackPrep" href="#DifferentiationInterface.PullbackPrep"><code>DifferentiationInterface.PullbackPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.pullback"><code>pullback</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PullbackSlow" href="#DifferentiationInterface.PullbackSlow"><code>DifferentiationInterface.PullbackSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PullbackSlow</code></pre><p>Trait identifying backends that do not support efficient pullbacks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardFast" href="#DifferentiationInterface.PushforwardFast"><code>DifferentiationInterface.PushforwardFast</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardFast</code></pre><p>Trait identifying backends that support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardPrep" href="#DifferentiationInterface.PushforwardPrep"><code>DifferentiationInterface.PushforwardPrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardPrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.pushforward"><code>pushforward</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.PushforwardSlow" href="#DifferentiationInterface.PushforwardSlow"><code>DifferentiationInterface.PushforwardSlow</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PushforwardSlow</code></pre><p>Trait identifying backends that do not support efficient pushforwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L48-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverForward" href="#DifferentiationInterface.ReverseOverForward"><code>DifferentiationInterface.ReverseOverForward</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverForward</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over forward mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.ReverseOverReverse" href="#DifferentiationInterface.ReverseOverReverse"><code>DifferentiationInterface.ReverseOverReverse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReverseOverReverse</code></pre><p>Traits identifying second-order backends that compute HVPs in reverse over reverse mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L121-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.SecondDerivativePrep" href="#DifferentiationInterface.SecondDerivativePrep"><code>DifferentiationInterface.SecondDerivativePrep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SecondDerivativePrep</code></pre><p>Abstract type for additional information needed by <a href="#DifferentiationInterface.second_derivative"><code>second_derivative</code></a> and its variants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/prep.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ADTypes.mode-Tuple{SecondOrder}" href="#ADTypes.mode-Tuple{SecondOrder}"><code>ADTypes.mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mode(backend::SecondOrder)</code></pre><p>Return the <em>outer</em> mode of the second-order backend.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/second_order.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.basis-Tuple{ADTypes.AbstractADType, AbstractArray, Any}" href="#DifferentiationInterface.basis-Tuple{ADTypes.AbstractADType, AbstractArray, Any}"><code>DifferentiationInterface.basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">basis(backend, a::AbstractArray, i)</code></pre><p>Construct the <code>i</code>-th standard basis array in the vector space of <code>a</code> with element type <code>eltype(a)</code>.</p><p><strong>Note</strong></p><p>If an AD backend benefits from a more specialized basis array implementation, this function can be extended on the backend type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/basis.jl#L39-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.inplace_support-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.inplace_support</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inplace_support(backend)</code></pre><p>Return <a href="#DifferentiationInterface.InPlaceSupported"><code>InPlaceSupported</code></a> or <a href="#DifferentiationInterface.InPlaceNotSupported"><code>InPlaceNotSupported</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.multibasis-Tuple{ADTypes.AbstractADType, AbstractArray, Any}" href="#DifferentiationInterface.multibasis-Tuple{ADTypes.AbstractADType, AbstractArray, Any}"><code>DifferentiationInterface.multibasis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multibasis(backend, a::AbstractArray, inds::AbstractVector)</code></pre><p>Construct the sum of the <code>i</code>-th standard basis arrays in the vector space of <code>a</code> with element type <code>eltype(a)</code>, for all <code>i ∈ inds</code>.</p><p><strong>Note</strong></p><p>If an AD backend benefits from a more specialized basis array implementation, this function can be extended on the backend type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/basis.jl#L51-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_derivative" href="#DifferentiationInterface.prepare!_derivative"><code>DifferentiationInterface.prepare!_derivative</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_derivative(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_derivative(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/derivative.jl#L15-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_gradient" href="#DifferentiationInterface.prepare!_gradient"><code>DifferentiationInterface.prepare!_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_gradient(f, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/gradient.jl#L13-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hessian" href="#DifferentiationInterface.prepare!_hessian"><code>DifferentiationInterface.prepare!_hessian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hessian(f, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hessian.jl#L13-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_hvp" href="#DifferentiationInterface.prepare!_hvp"><code>DifferentiationInterface.prepare!_hvp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_hvp(f, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/second_order/hvp.jl#L13-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_jacobian" href="#DifferentiationInterface.prepare!_jacobian"><code>DifferentiationInterface.prepare!_jacobian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_jacobian(f,     prep, backend, x, [contexts...]) -&gt; new_prep
prepare!_jacobian(f!, y, prep, backend, x, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/jacobian.jl#L15-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pullback" href="#DifferentiationInterface.prepare!_pullback"><code>DifferentiationInterface.prepare!_pullback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pullback(f,     prep, backend, x, ty, [contexts...]) -&gt; new_prep
prepare!_pullback(f!, y, prep, backend, x, ty, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pullback.jl#L15-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.prepare!_pushforward" href="#DifferentiationInterface.prepare!_pushforward"><code>DifferentiationInterface.prepare!_pushforward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare!_pushforward(f,     prep, backend, x, tx, [contexts...]) -&gt; new_prep
prepare!_pushforward(f!, y, prep, backend, x, tx, [contexts...]) -&gt; new_prep</code></pre><p>Same behavior as <a href="#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a> but can modify an existing <code>prep</code> object to avoid some allocations.</p><p>There is no guarantee that <code>prep</code> will be mutated, or that performance will be improved compared to preparation from scratch.</p><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>For efficiency, this function needs to rely on backend package internals, therefore it not protected by semantic versioning.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/first_order/pushforward.jl#L15-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pullback_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pullback_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pullback_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PullbackFast"><code>PullbackFast</code></a> or <a href="#DifferentiationInterface.PullbackSlow"><code>PullbackSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}" href="#DifferentiationInterface.pushforward_performance-Tuple{ADTypes.AbstractADType}"><code>DifferentiationInterface.pushforward_performance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pushforward_performance(backend)</code></pre><p>Return <a href="#DifferentiationInterface.PushforwardFast"><code>PushforwardFast</code></a> or <a href="#DifferentiationInterface.PushforwardSlow"><code>PushforwardSlow</code></a> in a statically predictable way.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/40ef1a7603e38f0a5088e650cb5366ab36068060/DifferentiationInterface/src/utils/traits.jl#L55-L59">source</a></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../explanation/advanced/">« Advanced features</a><a class="docs-footer-nextpage" href="../dev_guide/">Dev guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 5 November 2024 21:29">Tuesday 5 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
