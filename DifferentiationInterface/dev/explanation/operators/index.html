<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Operators · DifferentiationInterface.jl</title><meta name="title" content="Operators · DifferentiationInterface.jl"/><meta property="og:title" content="Operators · DifferentiationInterface.jl"/><meta property="twitter:title" content="Operators · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/basic/">Basic tutorial</a></li><li><a class="tocitem" href="../../tutorials/advanced/">Advanced tutorial</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li class="is-active"><a class="tocitem" href>Operators</a><ul class="internal"><li><a class="tocitem" href="#List-of-operators"><span>List of operators</span></a></li><li><a class="tocitem" href="#Variants"><span>Variants</span></a></li><li><a class="tocitem" href="#Mutation-and-signatures"><span>Mutation and signatures</span></a></li><li><a class="tocitem" href="#Preparation"><span>Preparation</span></a></li></ul></li><li><a class="tocitem" href="../backends/">Backends</a></li><li><a class="tocitem" href="../advanced/">Advanced features</a></li></ul></li><li><span class="tocitem">FAQ</span><ul><li><a class="tocitem" href="../../faq/limitations/">Limitations</a></li><li><a class="tocitem" href="../../faq/differentiability/">Differentiability</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../dev_guide/">Dev guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanation</a></li><li class="is-active"><a href>Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDiff/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/explanation/operators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Operators"><a class="docs-heading-anchor" href="#Operators">Operators</a><a id="Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Operators" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If there are some concepts you do not understand, take a look at the book <a href="https://arxiv.org/abs/2403.14606"><em>The Elements of Differentiable Programming</em></a> (Blondel and Roulet, 2024).</p></div></div><h2 id="List-of-operators"><a class="docs-heading-anchor" href="#List-of-operators">List of operators</a><a id="List-of-operators-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-operators" title="Permalink"></a></h2><p>Given a function <code>f(x) = y</code>, there are several differentiation operators available. The terminology depends on:</p><ul><li>the type and shape of the input <code>x</code></li><li>the type and shape of the output <code>y</code></li><li>the order of differentiation</li></ul><p>Below we list and describe all the operators we support.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The package is thoroughly tested with inputs and outputs of the following types: <code>Float64</code>, <code>Vector{Float64}</code> and <code>Matrix{Float64}</code>. We also expect it to work on most kinds of <code>Number</code> and <code>AbstractArray</code> variables. Beyond that, you are in uncharted territory. We voluntarily keep the type annotations minimal, so that passing more complex objects or custom structs <em>might work in some cases</em>, but we make no guarantees about that yet.</p></div></div><h3 id="High-level-operators"><a class="docs-heading-anchor" href="#High-level-operators">High-level operators</a><a id="High-level-operators-1"></a><a class="docs-heading-anchor-permalink" href="#High-level-operators" title="Permalink"></a></h3><p>These operators are computed using only the input <code>x</code>.</p><table><tr><th style="text-align: left">operator</th><th style="text-align: left">order</th><th style="text-align: left">input <code>x</code></th><th style="text-align: left">output <code>y</code></th><th style="text-align: left">operator result type</th><th style="text-align: left">operator result shape</th></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.derivative"><code>derivative</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left">similar to <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.second_derivative"><code>second_derivative</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left">similar to <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.gradient"><code>gradient</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left">similar to <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>AbstractMatrix</code></td><td style="text-align: left"><code>(length(y), length(x))</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hessian"><code>hessian</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>AbstractMatrix</code></td><td style="text-align: left"><code>(length(x), length(x))</code></td></tr></table><h3 id="Low-level-operators"><a class="docs-heading-anchor" href="#Low-level-operators">Low-level operators</a><a id="Low-level-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Low-level-operators" title="Permalink"></a></h3><p>These operators are computed using the input <code>x</code> and another argument <code>t</code> of type <code>NTuple</code>, which contains one or more tangents. You can think of tangents as perturbations propagated through the function; they live either in the same space as <code>x</code> or in the same space as <code>y</code>.</p><table><tr><th style="text-align: left">operator</th><th style="text-align: left">order</th><th style="text-align: left">input <code>x</code></th><th style="text-align: left">output <code>y</code></th><th style="text-align: left">element type of <code>t</code></th><th style="text-align: left">operator result type</th><th style="text-align: left">operator result shape</th></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a> (JVP)</td><td style="text-align: left">1</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left">similar to <code>x</code></td><td style="text-align: left">similar to <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pullback"><code>pullback</code></a> (VJP)</td><td style="text-align: left">1</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left">similar to <code>y</code></td><td style="text-align: left">similar to <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left">similar to <code>x</code></td><td style="text-align: left">similar to <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr></table><h2 id="Variants"><a class="docs-heading-anchor" href="#Variants">Variants</a><a id="Variants-1"></a><a class="docs-heading-anchor-permalink" href="#Variants" title="Permalink"></a></h2><p>Several variants of each operator are defined:</p><ul><li>out-of-place operators return a new derivative object</li><li>in-place operators mutate the provided derivative object</li></ul><table><tr><th style="text-align: left">out-of-place</th><th style="text-align: left">in-place</th><th style="text-align: left">out-of-place + primal</th><th style="text-align: left">in-place + primal</th></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.derivative"><code>derivative</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.derivative!"><code>derivative!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_derivative"><code>value_and_derivative</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_derivative!"><code>value_and_derivative!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.second_derivative"><code>second_derivative</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.second_derivative!"><code>second_derivative!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_derivative_and_second_derivative"><code>value_derivative_and_second_derivative</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_derivative_and_second_derivative!"><code>value_derivative_and_second_derivative!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.gradient"><code>gradient</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.gradient!"><code>gradient!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_gradient"><code>value_and_gradient</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_gradient!"><code>value_and_gradient!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hessian"><code>hessian</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hessian!"><code>hessian!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_gradient_and_hessian"><code>value_gradient_and_hessian</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_gradient_and_hessian!"><code>value_gradient_and_hessian!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.jacobian!"><code>jacobian!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_jacobian"><code>value_and_jacobian</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_jacobian!"><code>value_and_jacobian!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pushforward!"><code>pushforward!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_pushforward"><code>value_and_pushforward</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_pushforward!"><code>value_and_pushforward!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pullback"><code>pullback</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.pullback!"><code>pullback!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_pullback"><code>value_and_pullback</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.value_and_pullback!"><code>value_and_pullback!</code></a></td></tr><tr><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.hvp!"><code>hvp!</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.gradient_and_hvp"><code>gradient_and_hvp</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.gradient_and_hvp!"><code>gradient_and_hvp!</code></a></td></tr></table><h2 id="Mutation-and-signatures"><a class="docs-heading-anchor" href="#Mutation-and-signatures">Mutation and signatures</a><a id="Mutation-and-signatures-1"></a><a class="docs-heading-anchor-permalink" href="#Mutation-and-signatures" title="Permalink"></a></h2><p>Two kinds of functions are supported:</p><ul><li>out-of-place functions <code>f(x) = y</code></li><li>in-place functions <code>f!(y, x) = nothing</code></li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>In-place functions only work with <a href="../../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a>, <a href="../../api/#DifferentiationInterface.pullback"><code>pullback</code></a>, <a href="../../api/#DifferentiationInterface.derivative"><code>derivative</code></a> and <a href="../../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a>. The other operators <a href="../../api/#DifferentiationInterface.hvp"><code>hvp</code></a>, <a href="../../api/#DifferentiationInterface.gradient"><code>gradient</code></a> and <a href="../../api/#DifferentiationInterface.hessian"><code>hessian</code></a> require scalar outputs, so it makes no sense to mutate the number <code>y</code>.</p></div></div><p>This results in various operator signatures (the necessary arguments and their order):</p><table><tr><th style="text-align: left">function signature</th><th style="text-align: left">out-of-place operator (returns <code>result</code>)</th><th style="text-align: left">in-place  operator (mutates <code>result</code>)</th></tr><tr><td style="text-align: left">out-of-place function <code>f</code></td><td style="text-align: left"><code>op(f, backend, x, [t])</code></td><td style="text-align: left"><code>op!(f, result, backend, x, [t])</code></td></tr><tr><td style="text-align: left">in-place function <code>f!</code></td><td style="text-align: left"><code>op(f!, y, backend, x, [t])</code></td><td style="text-align: left"><code>op!(f!, y, result, backend, x, [t])</code></td></tr></table><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The positional arguments between <code>f</code>/<code>f!</code> and <code>backend</code> are always mutated, regardless of the bang <code>!</code> in the operator name. In particular, for in-place functions <code>f!(y, x)</code>, every variant of every operator will mutate <code>y</code>.</p></div></div><h2 id="Preparation"><a class="docs-heading-anchor" href="#Preparation">Preparation</a><a id="Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Preparation" title="Permalink"></a></h2><h3 id="Principle"><a class="docs-heading-anchor" href="#Principle">Principle</a><a id="Principle-1"></a><a class="docs-heading-anchor-permalink" href="#Principle" title="Permalink"></a></h3><p>In many cases, AD can be accelerated if the function has been called at least once (e.g. to record a tape) or if some cache objects are pre-allocated. This preparation procedure is backend-specific, but we expose a common syntax to achieve it.</p><table><tr><th style="text-align: left">operator</th><th style="text-align: left">preparation (different point)</th><th style="text-align: left">preparation (same point)</th></tr><tr><td style="text-align: left"><code>derivative</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>gradient</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>jacobian</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>second_derivative</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>hessian</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>pushforward</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a></td></tr><tr><td style="text-align: left"><code>pullback</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a></td></tr><tr><td style="text-align: left"><code>hvp</code></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a></td><td style="text-align: left"><a href="../../api/#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a></td></tr></table><p>In addition, the preparation syntax depends on the number of arguments accepted by the function.</p><table><tr><th style="text-align: left">function signature</th><th style="text-align: left">preparation signature</th></tr><tr><td style="text-align: left">out-of-place function</td><td style="text-align: left"><code>prepare_op(f, backend, x, [t])</code></td></tr><tr><td style="text-align: left">in-place function</td><td style="text-align: left"><code>prepare_op(f!, y, backend, x, [t])</code></td></tr></table><p>Preparation creates an object called <code>prep</code> which contains the the necessary information to speed up an operator and its variants. The idea is that you prepare only once, which can be costly, but then call the operator several times while reusing the same <code>prep</code>.</p><pre><code class="language-julia hljs">op(f, backend, x, [t])  # slow because it includes preparation
op(f, prep, backend, x, [t])  # fast because it skips preparation</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The <code>prep</code> object is the last argument before <code>backend</code> and it is always mutated, regardless of the bang <code>!</code> in the operator name.</p></div></div><h3 id="Reusing-preparation"><a class="docs-heading-anchor" href="#Reusing-preparation">Reusing preparation</a><a id="Reusing-preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Reusing-preparation" title="Permalink"></a></h3><p>It is not always safe to reuse the results of preparation. For different-point preparation, the output <code>prep</code> of</p><pre><code class="language-julia hljs">prepare_op(f, [y], backend, x, [t, contexts...])</code></pre><p>can be reused in subsequent calls to</p><pre><code class="language-julia hljs">op(f, prep, [other_y], backend, other_x, [other_t, other_contexts...])</code></pre><p>provided that the following conditions all hold:</p><ul><li><code>f</code> and <code>backend</code> remain the same</li><li><code>other_x</code> has the same type and size as <code>x</code></li><li><code>other_y</code> has the same type and size as <code>y</code></li><li><code>other_t</code> has the same type and size as <code>t</code></li><li>all the elements of <code>other_contexts</code> have the same type and size as the corresponding elements of <code>contexts</code></li></ul><p>For same-point preparation, the same rules hold with two modifications:</p><ul><li><code>other_x</code> must be <em>equal</em> to <code>x</code></li><li>any element of <code>other_contexts</code> with type <code>Constant</code> must be <em>equal</em> to the corresponding element of <code>contexts</code></li></ul><div class="admonition is-danger"><header class="admonition-header">Danger</header><div class="admonition-body"><p>Reusing preparation with different types or sizes may work with some backends and error with others, so it is not allowed by the API of DifferentiationInterface.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>These rules hold for the majority of backends, but there are some exceptions. The most important exception is <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AutoReverseDiff">ReverseDiff</a> and its taping mechanism, which is sensitive to control flow inside the function.</p></div></div><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/advanced/">« Advanced tutorial</a><a class="docs-footer-nextpage" href="../backends/">Backends »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 10 February 2025 00:41">Monday 10 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
